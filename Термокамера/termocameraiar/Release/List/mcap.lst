##############################################################################
#                                                                            #
# IAR Atmel AVR C/EC++ Compiler V3.20C/W32             09/Aug/2006  12:23:04 #
# Copyright 1996-2004 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Source file  =  D:\temp\sys_msap01mk_dev0103\mcap.c                     #
#    Command line =  --cpu=m128 -ms -o D:\temp\sys_msap01mk_dev0103\Release\ #
#                    Obj\ -lCN D:\temp\sys_msap01mk_dev0103\Release\List\    #
#                    -y --initializers_in_flash -s9                          #
#                    -DENABLE_BIT_DEFINITIONS -e -I "F:\Program Files\IAR    #
#                    Systems\Embedded Workbench 3.2\avr\INC\" -I             #
#                    "F:\Program Files\IAR Systems\Embedded Workbench        #
#                    3.2\avr\INC\CLIB\" --eeprom_size 4096                   #
#                    D:\temp\sys_msap01mk_dev0103\mcap.c                     #
#    List file    =  D:\temp\sys_msap01mk_dev0103\Release\List\mcap.lst      #
#    Object file  =  D:\temp\sys_msap01mk_dev0103\Release\Obj\mcap.r90       #
#                                                                            #
#                                                                            #
##############################################################################

D:\temp\sys_msap01mk_dev0103\mcap.c
      1          #include <iom128.h>
      2          #include "ina90.h"
      3          #include "mbsl0.h"
      4          #include "mbsl1.h"
      5          #include "string.h"
      6          #include "stdio.h"
      7          #include "led.h"
      8          #include "types.h"
      9          #include "base.h"
     10          #include "timeservice.h"
     11          #include "zerodef.h"
     12          #include "hist.h"
     13          
     14          #include "OneWire\OW.h"
     15          #include "OneWire\main.h"
     16          extern char res_fl;
     17          extern char chmaskout;
     18          int tmv;
     19          int inn;
     20          int t1;
     21          int t2;
     22          int k;
     23          int t3;
     24          int qwerty;
     25          int t4;
     26          int t5;
     27          int mmm;
     28          UINT get_sp();
     29                
     30          extern struct isr_cntx u0,u1;
     31          /*
     32          struct isr_cntx {
     33            char flag35;
     34            char state;
     35            unsigned char l;
     36            char addr;
     37            char rbuf[8];
     38          //  char tbuf[263];
     39            char tbuf[128+8];
     40           };
     41          */

   \                                 In segment CODE, align 2, keep-with-next
     42          mbdiagn(){
   \                     mbdiagn:
   \   00000000   2F3B                       MOV     R19,R27
   \   00000002   2F4A                       MOV     R20,R26
     43          _ID
   \   00000004   94F8                       CLI
     44          hrem[0x110]=u0.flag35+(u1.flag35<<8);
   \   00000006   ....                       LDI     R26,LOW(u0)
   \   00000008   ....                       LDI     R27,(u0) >> 8
   \   0000000A   ....                       LDI     R30,LOW(u1)
   \   0000000C   ....                       LDI     R31,(u1) >> 8
   \   0000000E   912C                       LD      R18,X
   \   00000010   8110                       LD      R17,Z
   \   00000012   9320....                   STS     (hrem + 544),R18
   \   00000016   9310....                   STS     (hrem + 545),R17
     45          hrem[0x111]=u0.state+(u1.state<<8);
   \   0000001A   9611                       ADIW    R27 : R26,1
   \   0000001C   912D                       LD      R18,X+
   \   0000001E   8111                       LDD     R17,Z+1
   \   00000020   9320....                   STS     (hrem + 546),R18
   \   00000024   9310....                   STS     (hrem + 547),R17
     46          hrem[0x112]=u0.l+(u1.l<<8);
   \   00000028   912D                       LD      R18,X+
   \   0000002A   8112                       LDD     R17,Z+2
   \   0000002C   9320....                   STS     (hrem + 548),R18
   \   00000030   9310....                   STS     (hrem + 549),R17
     47          hrem[0x113]=u0.addr+(u1.addr<<8);
   \   00000034   912D                       LD      R18,X+
   \   00000036   8113                       LDD     R17,Z+3
   \   00000038   9320....                   STS     (hrem + 550),R18
   \   0000003C   9310....                   STS     (hrem + 551),R17
     48          hrem[0x114]=u0.rbuf[0]+(u1.rbuf[0]<<8);
   \   00000040   912D                       LD      R18,X+
   \   00000042   8114                       LDD     R17,Z+4
   \   00000044   9320....                   STS     (hrem + 552),R18
   \   00000048   9310....                   STS     (hrem + 553),R17
     49          hrem[0x115]=u0.rbuf[1]+(u1.rbuf[1]<<8);
   \   0000004C   912D                       LD      R18,X+
   \   0000004E   8115                       LDD     R17,Z+5
   \   00000050   9320....                   STS     (hrem + 554),R18
   \   00000054   9310....                   STS     (hrem + 555),R17
     50          hrem[0x116]=u0.rbuf[2]+(u1.rbuf[2]<<8);
   \   00000058   912D                       LD      R18,X+
   \   0000005A   8116                       LDD     R17,Z+6
   \   0000005C   9320....                   STS     (hrem + 556),R18
   \   00000060   9310....                   STS     (hrem + 557),R17
     51          hrem[0x117]=u0.rbuf[3]+(u1.rbuf[3]<<8);
   \   00000064   912D                       LD      R18,X+
   \   00000066   8117                       LDD     R17,Z+7
   \   00000068   9320....                   STS     (hrem + 558),R18
   \   0000006C   9310....                   STS     (hrem + 559),R17
     52          hrem[0x118]=u0.rbuf[4]+(u1.rbuf[4]<<8);
   \   00000070   912D                       LD      R18,X+
   \   00000072   8510                       LDD     R17,Z+8
   \   00000074   9320....                   STS     (hrem + 560),R18
   \   00000078   9310....                   STS     (hrem + 561),R17
     53          hrem[0x119]=u0.rbuf[5]+(u1.rbuf[5]<<8);
   \   0000007C   912C                       LD      R18,X
   \   0000007E   9614                       ADIW    R27 : R26,4
   \   00000080   8511                       LDD     R17,Z+9
   \   00000082   9320....                   STS     (hrem + 562),R18
   \   00000086   9310....                   STS     (hrem + 563),R17
     54          hrem[0x11a]=u0.tbuf[1]+(u1.tbuf[1]<<8);
   \   0000008A   912C                       LD      R18,X
   \   0000008C   8515                       LDD     R17,Z+13
   \   0000008E   ....                       LDI     R30,LOW((hrem + 564))
   \   00000090   ....                       LDI     R31,(hrem + 564) >> 8
   \   00000092   8320                       ST      Z,R18
   \   00000094   8311                       STD     Z+1,R17
     55          hrem[0x11b]=TIFR;
   \   00000096   B706                       IN      R16,0x36
   \   00000098   E010                       LDI     R17,0
   \   0000009A   ....                       LDI     R30,LOW((hrem + 566))
   \   0000009C   ....                       LDI     R31,(hrem + 566) >> 8
   \   0000009E   8300                       ST      Z,R16
   \   000000A0   8311                       STD     Z+1,R17
     56          hrem[0x11c]=UCSR0B;
   \   000000A2   B10A                       IN      R16,0x0A
   \   000000A4   ....                       LDI     R30,LOW((hrem + 568))
   \   000000A6   ....                       LDI     R31,(hrem + 568) >> 8
   \   000000A8   8300                       ST      Z,R16
   \   000000AA   8311                       STD     Z+1,R17
     57          hrem[0x11d]=UCSR0C;
   \   000000AC   91000095                   LDS     R16,149
   \   000000B0   ....                       LDI     R30,LOW((hrem + 570))
   \   000000B2   ....                       LDI     R31,(hrem + 570) >> 8
   \   000000B4   8300                       ST      Z,R16
   \   000000B6   8311                       STD     Z+1,R17
     58          hrem[0x11d]=TIMSK;
   \   000000B8   B707                       IN      R16,0x37
   \   000000BA   8300                       ST      Z,R16
   \   000000BC   8311                       STD     Z+1,R17
     59          _IE
   \   000000BE   9478                       SEI
     60          
     61          }
   \   000000C0   2FA4                       MOV     R26,R20
   \   000000C2   2FB3                       MOV     R27,R19
   \   000000C4   9508                       RET

   \                                 In segment CODE, align 2, keep-with-next
     62          void delayloop(unsigned int d){
   \                     delayloop:
     63          unsigned int i,i2;
     64          for (i=0;i<d;i++)
   \   00000000   2F20                       MOV     R18,R16
   \   00000002   2B21                       OR      R18,R17
   \   00000004   F061                       BREQ    ??delayloop_0
     65            for (i2=0;i2<1100;i2++) _NOP();
   \                     ??delayloop_1:
   \   00000006   E4EC                       LDI     R30,76
   \   00000008   E0F4                       LDI     R31,4
   \                     ??delayloop_2:
   \   0000000A   0000                       NOP
   \   0000000C   9731                       SBIW    R31 : R30,1
   \   0000000E   2F2E                       MOV     R18,R30
   \   00000010   2B2F                       OR      R18,R31
   \   00000012   F7D9                       BRNE    ??delayloop_2
   \   00000014   5001                       SUBI    R16,1
   \   00000016   4010                       SBCI    R17,0
   \   00000018   2F20                       MOV     R18,R16
   \   0000001A   2B21                       OR      R18,R17
   \   0000001C   F7A1                       BRNE    ??delayloop_1
     66          };
   \                     ??delayloop_0:
   \   0000001E   9508                       RET
     67          //                                                                                                    #pragma inline
     68          
     69          ///////////////////////////////////////////////////////////////////////////
     70          // Инициируем порты ввода вывода для чтения перемычек и зажигания лампочек

   \                                 In segment CODE, align 2, keep-with-next
     71          void iniports(){
   \                     iniports:
     72          //  DDRB=0XFF;
     73          //  DDRA=0XFF;
     74            
     75            DDRC = 0xff; //Лампочки на вывод
   \   00000000   EF0F                       LDI     R16,255
   \   00000002   BB04                       OUT     0x14,R16
     76            DDRG = 0x03;
   \   00000004   E003                       LDI     R16,3
   \   00000006   93000064                   STS     100,R16
     77            PORTC = 0x00;
   \   0000000A   E000                       LDI     R16,0
   \   0000000C   BB05                       OUT     0x15,R16
     78            PORTG = 0x00;
   \   0000000E   93000065                   STS     101,R16
     79            redonw
   \   00000012   9AAF                       SBI     0x15,0x07
     80          
     81            PORTG_Bit3=1; //Включить PULUP на перемычки
   \   00000014   91000065                   LDS     R16,101
   \   00000018   6008                       ORI     R16,0x08
   \   0000001A   93000065                   STS     101,R16
     82            PORTG_Bit4=1;
   \   0000001E   6100                       ORI     R16,0x10
   \   00000020   93000065                   STS     101,R16
     83            PORTD_Bit6=1;
   \   00000024   9A96                       SBI     0x12,0x06
     84            PORTD_Bit7=1;
   \   00000026   9A97                       SBI     0x12,0x07
     85            
     86          }
   \   00000028   9508                       RET
     87          /*******************************************************************************
     88           процесс индикации
     89          *******************************************************************************/ 
     90          #define nt 1000
     91          char ledstate;
     92          extern char lineflags; // бит 0-3 подключен датчик 4-7 - более одного нового датчика

   \                                 In segment CODE, align 2, keep-with-next
     93          void ledpr(){
   \                     ledpr:
   \   00000000   93BA                       ST      -Y,R27
   \   00000002   93AA                       ST      -Y,R26
     94              if ((ramb[0x18]&0x7f00)!=0) {//поломка сигнализатора
   \   00000004   ....                       LDI     R26,LOW(ramb)
   \   00000006   ....                       LDI     R27,(ramb) >> 8
   \   00000008   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000000A   A911                       LDD     R17,Z+49
   \   0000000C   771F                       ANDI    R17,0x7F
   \   0000000E   F059                       BREQ    ??ledpr_0
     95                      if ((time&1024)==0){grw=1;redw=0; }
   \   00000010   ....                       LDI     R30,LOW(time)
   \   00000012   ....                       LDI     R31,(time) >> 8
   \   00000014   8101                       LDD     R16,Z+1
   \   00000016   FD02                       SBRC    R16,2
   \   00000018   C003                       RJMP    ??ledpr_1
   \   0000001A   9AAE                       SBI     0x15,0x06
   \   0000001C   98AF                       CBI     0x15,0x07
   \   0000001E   C13A                       RJMP    ??ledpr_2
     96                      else {grw=0;redw=1;}
   \                     ??ledpr_1:
   \   00000020   98AE                       CBI     0x15,0x06
   \   00000022   9AAF                       SBI     0x15,0x07
   \   00000024   C137                       RJMP    ??ledpr_2
     97                      return;
     98              }
     99          
    100             if ((ramb[0x18]&0x8000)!=0){ //режим конфигурирования микролан)
   \                     ??ledpr_0:
   \   00000026   A901                       LDD     R16,Z+49
   \   00000028   FF07                       SBRS    R16,7
   \   0000002A   C096                       RJMP    ??ledpr_3
    101                if (ledstate!= 2){ //только что перешли в режим конфигурирования микролан
   \   0000002C   9100....                   LDS     R16,ledstate
   \   00000030   3002                       CPI     R16,2
   \   00000032   F0E9                       BREQ    ??ledpr_4
    102                   offw; off1;  off2; off3; off4; 
   \   00000034   B305                       IN      R16,0x15
   \   00000036   730F                       ANDI    R16,0x3F
   \   00000038   BB05                       OUT     0x15,R16
   \   0000003A   B305                       IN      R16,0x15
   \   0000003C   7C0F                       ANDI    R16,0xCF
   \   0000003E   BB05                       OUT     0x15,R16
   \   00000040   B305                       IN      R16,0x15
   \   00000042   7F03                       ANDI    R16,0xF3
   \   00000044   BB05                       OUT     0x15,R16
   \   00000046   B305                       IN      R16,0x15
   \   00000048   7F0C                       ANDI    R16,0xFC
   \   0000004A   BB05                       OUT     0x15,R16
   \   0000004C   91000065                   LDS     R16,101
   \   00000050   7F0E                       ANDI    R16,0xFE
   \   00000052   93000065                   STS     101,R16
   \   00000056   7F0D                       ANDI    R16,0xFD
   \   00000058   93000065                   STS     101,R16
    103                   ledstate=2;
   \   0000005C   E002                       LDI     R16,2
   \                     ??ledpr_5:
   \   0000005E   9300....                   STS     ledstate,R16
    104                   settout(0,nt);
   \   00000062   EE28                       LDI     R18,232
   \   00000064   E033                       LDI     R19,3
   \   00000066   E000                       LDI     R16,0
   \   00000068   ........                   CALL    settout
    105                   return;
   \   0000006C   C113                       RJMP    ??ledpr_2
    106                }else if (gettout(0)==0) {
   \                     ??ledpr_4:
   \   0000006E   E000                       LDI     R16,0
   \   00000070   ........                   CALL    gettout
   \   00000074   2300                       TST     R16
   \   00000076   F009                       BREQ    $+2+2
   \   00000078   C10D                       RJMP    ??ledpr_2
    107                          if (lineflags==0) {
   \   0000007A   9100....                   LDS     R16,lineflags
   \   0000007E   2300                       TST     R16
   \   00000080   EE28                       LDI     R18,232
   \   00000082   E033                       LDI     R19,3
   \   00000084   E000                       LDI     R16,0
   \   00000086   F4C1                       BRNE    ??ledpr_6
    108                             { settout(0,nt);grw^=1;gr1^=1;gr2^=1;gr3^=1;gr4 ^=1; return;}
   \   00000088   ........                   CALL    settout
   \   0000008C   E400                       LDI     R16,64
   \   0000008E   B315                       IN      R17,0x15
   \   00000090   2710                       EOR     R17,R16
   \   00000092   BB15                       OUT     0x15,R17
   \   00000094   E100                       LDI     R16,16
   \   00000096   B315                       IN      R17,0x15
   \   00000098   2710                       EOR     R17,R16
   \   0000009A   BB15                       OUT     0x15,R17
   \   0000009C   E004                       LDI     R16,4
   \   0000009E   B315                       IN      R17,0x15
   \   000000A0   2710                       EOR     R17,R16
   \   000000A2   BB15                       OUT     0x15,R17
   \   000000A4   E001                       LDI     R16,1
   \   000000A6   B315                       IN      R17,0x15
   \   000000A8   2710                       EOR     R17,R16
   \   000000AA   BB15                       OUT     0x15,R17
   \   000000AC   91100065                   LDS     R17,101
   \   000000B0   2710                       EOR     R17,R16
   \   000000B2   93100065                   STS     101,R17
   \   000000B6   C0EE                       RJMP    ??ledpr_2
    109                          }else {  settout(0,nt);
   \                     ??ledpr_6:
   \   000000B8   ........                   CALL    settout
    110                                  if ((lineflags&0xf0)!=0)  {  grw=0; redw=1;}
   \   000000BC   9100....                   LDS     R16,lineflags
   \   000000C0   7F00                       ANDI    R16,0xF0
   \   000000C2   F019                       BREQ    ??ledpr_7
   \   000000C4   98AE                       CBI     0x15,0x06
   \   000000C6   9AAF                       SBI     0x15,0x07
   \   000000C8   C005                       RJMP    ??ledpr_8
    111                                  else {grw^=1;redw=0;} 
   \                     ??ledpr_7:
   \   000000CA   E400                       LDI     R16,64
   \   000000CC   B315                       IN      R17,0x15
   \   000000CE   2710                       EOR     R17,R16
   \   000000D0   BB15                       OUT     0x15,R17
   \   000000D2   98AF                       CBI     0x15,0x07
    112                                      //проверяем флаги по каждой линии  на ошибочное подключение
    113                                   // if ((lineflags&0x10)!=0) {gr1=0;red1^=1;}  
    114                                    if ((lineflags&0x20)!=0) {gr2=0;red2^=1;}
   \                     ??ledpr_8:
   \   000000D4   ....                       LDI     R30,LOW(lineflags)
   \   000000D6   ....                       LDI     R31,(lineflags) >> 8
   \   000000D8   8100                       LD      R16,Z
   \   000000DA   FF05                       SBRS    R16,5
   \   000000DC   C005                       RJMP    ??ledpr_9
   \   000000DE   98AA                       CBI     0x15,0x02
   \   000000E0   E008                       LDI     R16,8
   \   000000E2   B315                       IN      R17,0x15
   \   000000E4   2710                       EOR     R17,R16
   \   000000E6   BB15                       OUT     0x15,R17
    115                                    if ((lineflags&0x40)!=0) {gr3=0;red3^=1;}                          
   \                     ??ledpr_9:
   \   000000E8   8100                       LD      R16,Z
   \   000000EA   FF06                       SBRS    R16,6
   \   000000EC   C005                       RJMP    ??ledpr_10
   \   000000EE   98A8                       CBI     0x15,0x00
   \   000000F0   E002                       LDI     R16,2
   \   000000F2   B315                       IN      R17,0x15
   \   000000F4   2710                       EOR     R17,R16
   \   000000F6   BB15                       OUT     0x15,R17
    116                                    if ((lineflags&0x80)!=0) {gr4=0;}//red4^=1;}
   \                     ??ledpr_10:
   \   000000F8   8100                       LD      R16,Z
   \   000000FA   FF07                       SBRS    R16,7
   \   000000FC   C005                       RJMP    ??ledpr_11
   \   000000FE   91000065                   LDS     R16,101
   \   00000102   7F0E                       ANDI    R16,0xFE
   \   00000104   93000065                   STS     101,R16
    117                                      //проверяем флаги на каждой линии на появление нового датчика  
    118                                 //   if ((lineflags&1)!=0) {gr1=0;red1^=1;if (red1==0)lineflags&=~1;}  
    119                                  if ((lineflags&2)!=0) {gr2=0;red2^=1;if (red2==0)lineflags&=~2;}
   \                     ??ledpr_11:
   \   00000108   8100                       LD      R16,Z
   \   0000010A   FF01                       SBRS    R16,1
   \   0000010C   C00A                       RJMP    ??ledpr_12
   \   0000010E   98AA                       CBI     0x15,0x02
   \   00000110   E008                       LDI     R16,8
   \   00000112   B315                       IN      R17,0x15
   \   00000114   2710                       EOR     R17,R16
   \   00000116   BB15                       OUT     0x15,R17
   \   00000118   99AB                       SBIC    0x15,0x03
   \   0000011A   C003                       RJMP    ??ledpr_12
   \   0000011C   8100                       LD      R16,Z
   \   0000011E   7F0D                       ANDI    R16,0xFD
   \   00000120   8300                       ST      Z,R16
    120                                    if ((lineflags&4)!=0) {gr3=0;red3^=1;if (red3==0)lineflags&=~4;}                          
   \                     ??ledpr_12:
   \   00000122   8100                       LD      R16,Z
   \   00000124   FF02                       SBRS    R16,2
   \   00000126   C00A                       RJMP    ??ledpr_13
   \   00000128   98A8                       CBI     0x15,0x00
   \   0000012A   E002                       LDI     R16,2
   \   0000012C   B315                       IN      R17,0x15
   \   0000012E   2710                       EOR     R17,R16
   \   00000130   BB15                       OUT     0x15,R17
   \   00000132   99A9                       SBIC    0x15,0x01
   \   00000134   C003                       RJMP    ??ledpr_13
   \   00000136   8100                       LD      R16,Z
   \   00000138   7F0B                       ANDI    R16,0xFB
   \   0000013A   8300                       ST      Z,R16
    121                                    if ((lineflags&8)!=0) {gr4=0;if (red4==0)lineflags&=~8;}
   \                     ??ledpr_13:
   \   0000013C   8100                       LD      R16,Z
   \   0000013E   FF03                       SBRS    R16,3
   \   00000140   C0A9                       RJMP    ??ledpr_2
   \   00000142   91000065                   LDS     R16,101
   \   00000146   7F0E                       ANDI    R16,0xFE
   \   00000148   93000065                   STS     101,R16
   \   0000014C   FD01                       SBRC    R16,1
   \   0000014E   C0A2                       RJMP    ??ledpr_2
   \   00000150   8100                       LD      R16,Z
   \   00000152   7F07                       ANDI    R16,0xF7
   \   00000154   8300                       ST      Z,R16
   \   00000156   C09E                       RJMP    ??ledpr_2
    122                                  return;  
    123                          };
    124                };
    125                }
    126            else{ // индикация в режиме Работа
    127          
    128                if ((ledstate&0x0f)!= 3){ //только что перешли в режим работа
   \                     ??ledpr_3:
   \   00000158   9100....                   LDS     R16,ledstate
   \   0000015C   700F                       ANDI    R16,0x0F
   \   0000015E   3003                       CPI     R16,3
   \   00000160   F0A9                       BREQ    ??ledpr_14
    129                   off1;  off2; off3; off4; 
   \   00000162   B305                       IN      R16,0x15
   \   00000164   7C0F                       ANDI    R16,0xCF
   \   00000166   BB05                       OUT     0x15,R16
   \   00000168   B305                       IN      R16,0x15
   \   0000016A   7F03                       ANDI    R16,0xF3
   \   0000016C   BB05                       OUT     0x15,R16
   \   0000016E   B305                       IN      R16,0x15
   \   00000170   7F0C                       ANDI    R16,0xFC
   \   00000172   BB05                       OUT     0x15,R16
   \   00000174   91000065                   LDS     R16,101
   \   00000178   7F0E                       ANDI    R16,0xFE
   \   0000017A   93000065                   STS     101,R16
   \   0000017E   7F0D                       ANDI    R16,0xFD
   \   00000180   93000065                   STS     101,R16
    130                   redw=0;
   \   00000184   98AF                       CBI     0x15,0x07
    131                   grw=1; //зажгли зеленую;
   \   00000186   9AAE                       SBI     0x15,0x06
    132                   ledstate=3;
   \   00000188   E003                       LDI     R16,3
   \   0000018A   CF69                       RJMP    ??ledpr_5
    133                   settout(0,nt);
    134                   return;
    135                }else {
    136                   if ((SEND0!=0)||SEND1!=0){ //идет передача по модбасу
   \                     ??ledpr_14:
   \   0000018C   9100....                   LDS     R16,ledstate
   \   00000190   7F00                       ANDI    R16,0xF0
   \   00000192   99D8                       SBIC    0x1B,0x00
   \   00000194   C002                       RJMP    ??ledpr_15
   \   00000196   9BC6                       SBIS    0x18,0x06
   \   00000198   C01E                       RJMP    ??ledpr_16
    137                       redw=0; 
   \                     ??ledpr_15:
   \   0000019A   98AF                       CBI     0x15,0x07
    138                       if ((ledstate&0xf0)==0){//до этого передачи не было
   \   0000019C   F451                       BRNE    ??ledpr_17
    139                           grw=0;settout(0,nt);
   \   0000019E   98AE                       CBI     0x15,0x06
   \   000001A0   EE28                       LDI     R18,232
   \   000001A2   E033                       LDI     R19,3
   \   000001A4   E000                       LDI     R16,0
   \   000001A6   ........                   CALL    settout
    140                           ledstate=0x83;
   \   000001AA   E803                       LDI     R16,131
   \                     ??ledpr_18:
   \   000001AC   9300....                   STS     ledstate,R16
   \   000001B0   C020                       RJMP    ??ledpr_19
    141                       } else { //до этого уже был режим передачи 
    142                           if(gettout(0)!=0) goto lineled;
   \                     ??ledpr_17:
   \   000001B2   E000                       LDI     R16,0
   \   000001B4   ........                   CALL    gettout
   \   000001B8   2300                       TST     R16
   \   000001BA   F4D9                       BRNE    ??ledpr_19
    143                           if (grw==0){// зеленая не горела слишком долго
   \   000001BC   99AE                       SBIC    0x15,0x06
   \   000001BE   C007                       RJMP    ??ledpr_20
    144                            grw=1;settout(0,200);//зажгли зеленую на 200мс
   \   000001C0   9AAE                       SBI     0x15,0x06
   \   000001C2   EC28                       LDI     R18,200
   \   000001C4   E030                       LDI     R19,0
   \                     ??ledpr_21:
   \   000001C6   E000                       LDI     R16,0
   \   000001C8   ........                   CALL    settout
    145                            goto lineled;
   \   000001CC   C012                       RJMP    ??ledpr_19
    146                           }else { //тушим зеленую и взводим таймаут
    147                            grw=0; settout(0,nt);
   \                     ??ledpr_20:
   \   000001CE   98AE                       CBI     0x15,0x06
   \   000001D0   EE28                       LDI     R18,232
   \   000001D2   E033                       LDI     R19,3
   \   000001D4   CFF8                       RJMP    ??ledpr_21
    148                            goto lineled;
    149                           } 
    150                       }  
    151                   }else if ((ledstate&0xf0)==0){ //до этого передачи не было
   \                     ??ledpr_16:
   \   000001D6   F061                       BREQ    ??ledpr_22
    152                             grw=1; goto lineled;
    153                         } else if (grw!=0){ //была передача но горел зеленый, значит до этого он слишком долго 
   \   000001D8   9BAE                       SBIS    0x15,0x06
   \   000001DA   C007                       RJMP    ??ledpr_23
    154                                             //не горел. Остаемся в том же состоянии пока не истечет таймаут на зеленый
    155                                   if (gettout(0)!=0) {goto lineled;}
   \   000001DC   E000                       LDI     R16,0
   \   000001DE   ........                   CALL    gettout
   \   000001E2   2300                       TST     R16
   \   000001E4   F431                       BRNE    ??ledpr_19
    156                                   else ledstate=3; // сбросили флаг отработки автомата индикации приема   
   \   000001E6   E003                       LDI     R16,3
   \   000001E8   CFE1                       RJMP    ??ledpr_18
    157                                }else { //зеленый не горел - просто зажжем его и сбросим автомат
    158                                    ledstate=3; grw=1;
   \                     ??ledpr_23:
   \   000001EA   E003                       LDI     R16,3
   \   000001EC   9300....                   STS     ledstate,R16
   \                     ??ledpr_22:
   \   000001F0   9AAE                       SBI     0x15,0x06
    159                                    goto lineled;
    160                                }                   
    161                   
    162          lineled:  // обработка индикации шлейфа
    163          /*  
    164                    if ((ramb[0x018]&1)!=0) { //неисправность шлейфа 1
    165                        if ((time&1024)==0){gr1=1;red1=0;}
    166                      else {gr1=0;red1=1;}
    167                    }else if((hrem[0x160]!=0)||(hrem[0x161]!=0)) {gr1=0;red1=1;}//тревога шлейфа 
    168                          else {gr1=1;red1=0;}; //шлейф в норме
    169                          
    170                    }
    171                    if ((ramb[0x018]&2)!=0) { //неисправность шлейфа 2
    172                        if ((time&1024)==0){gr2=1;red2=0;}
    173                      else {gr2=0;red2=1;}
    174                    }else if((hrem[0x162]!=0)||(hrem[0x163]!=0)) {gr2=0;red2=1;}//тревога шлейфа 
    175                          else {gr2=1;red2=0;}; //шлейф в норме
    176                     
    177                    if ((ramb[0x018]&4)!=0) { //неисправность шлейфа 3
    178                        if ((time&1024)==0){gr3=1;red3=0;}
    179                      else {gr3=0;red3=1;}
    180                    }else if((hrem[0x164]!=0)||(hrem[0x165]!=0)) {gr3=0;red3=1;}//тревога шлейфа 
    181                          else {gr3=1;red3=0;}; //шлейф в норме
    182                     
    183                    if ((ramb[0x018]&8)!=0) { //неисправность шлейфа 4
    184                        if ((time&1024)==0){gr4=1;red4=0;}
    185                      else {gr4=0;red4=1;}
    186                    }else if((hrem[0x166]!=0)||(hrem[0x167]!=0)) {gr4=0;red4=1;}//тревога шлейфа 
    187                          else {gr4=1;red4=0;}; //шлейф в норме
    188          */
    189                    
    190                //if((hrem[0x160]!=0)||(hrem[0x161]!=0)) {gr1=0;red1=1;}//тревога шлейфа 
    191                        // else 
    192                           if (((ramb[0x018]&1)!=0)||((chmaskout&1)!=0) ){ //неисправность шлейфа 1
   \                     ??ledpr_19:
   \   000001F2   01FD                       MOVW    R31 : R30,R27 : R26
   \   000001F4   A900                       LDD     R16,Z+48
   \   000001F6   7001                       ANDI    R16,0x01
   \   000001F8   ....                       LDI     R30,LOW(chmaskout)
   \   000001FA   ....                       LDI     R31,(chmaskout) >> 8
   \   000001FC   8110                       LD      R17,Z
   \   000001FE   7011                       ANDI    R17,0x01
   \   00000200   2B10                       OR      R17,R16
   \   00000202   F051                       BREQ    ??ledpr_24
    193                                if ((time&1024)==0){gr1=1;red1=0;}
   \   00000204   ....                       LDI     R30,LOW(time)
   \   00000206   ....                       LDI     R31,(time) >> 8
   \   00000208   8101                       LDD     R16,Z+1
   \   0000020A   FD02                       SBRC    R16,2
   \   0000020C   C003                       RJMP    ??ledpr_25
   \   0000020E   9AAC                       SBI     0x15,0x04
   \   00000210   98AD                       CBI     0x15,0x05
   \   00000212   C002                       RJMP    ??ledpr_24
    194                                else {gr1=0;red1=1;};
   \                     ??ledpr_25:
   \   00000214   98AC                       CBI     0x15,0x04
   \   00000216   9AAD                       SBI     0x15,0x05
    195                       }//else {gr1=1;red1=0;}; //шлейф в норме
    196                    
    197          
    198                  if((hrem[0x162]!=0)||(hrem[0x163]!=0)) {gr2=0;red2=1;}//тревога шлейфа 
   \                     ??ledpr_24:
   \   00000218   ....                       LDI     R30,LOW((hrem + 708))
   \   0000021A   ....                       LDI     R31,(hrem + 708) >> 8
   \   0000021C   8100                       LD      R16,Z
   \   0000021E   8111                       LDD     R17,Z+1
   \   00000220   2B01                       OR      R16,R17
   \   00000222   F431                       BRNE    ??ledpr_26
   \   00000224   ....                       LDI     R30,LOW((hrem + 710))
   \   00000226   ....                       LDI     R31,(hrem + 710) >> 8
   \   00000228   8100                       LD      R16,Z
   \   0000022A   8111                       LDD     R17,Z+1
   \   0000022C   2B01                       OR      R16,R17
   \   0000022E   F019                       BREQ    ??ledpr_27
   \                     ??ledpr_26:
   \   00000230   98AA                       CBI     0x15,0x02
   \   00000232   9AAB                       SBI     0x15,0x03
   \   00000234   C010                       RJMP    ??ledpr_28
    199                        else 
    200                            if (((ramb[0x018]&2)!=0)||((chmaskout&2)!=0) ){ //неисправность шлейфа 2
   \                     ??ledpr_27:
   \   00000236   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000238   A900                       LDD     R16,Z+48
   \   0000023A   FD01                       SBRC    R16,1
   \   0000023C   C005                       RJMP    ??ledpr_29
   \   0000023E   ....                       LDI     R30,LOW(chmaskout)
   \   00000240   ....                       LDI     R31,(chmaskout) >> 8
   \   00000242   8100                       LD      R16,Z
   \   00000244   FF01                       SBRS    R16,1
   \   00000246   C005                       RJMP    ??ledpr_30
    201                                 if ((time&1024)==0){gr2=1;red2=0;}
   \                     ??ledpr_29:
   \   00000248   ....                       LDI     R30,LOW(time)
   \   0000024A   ....                       LDI     R31,(time) >> 8
   \   0000024C   8101                       LDD     R16,Z+1
   \   0000024E   FD02                       SBRC    R16,2
   \   00000250   CFEF                       RJMP    ??ledpr_26
    202                                 else {gr2=0;red2=1;}
    203                            }else {gr2=1;red2=0;}; //шлейф в норме
   \                     ??ledpr_30:
   \   00000252   9AAA                       SBI     0x15,0x02
   \   00000254   98AB                       CBI     0x15,0x03
    204                    
    205                    if((hrem[0x164]!=0)||(hrem[0x165]!=0)) {gr3=0;red3=1;}//тревога шлейфа 
   \                     ??ledpr_28:
   \   00000256   ....                       LDI     R30,LOW((hrem + 712))
   \   00000258   ....                       LDI     R31,(hrem + 712) >> 8
   \   0000025A   8100                       LD      R16,Z
   \   0000025C   8111                       LDD     R17,Z+1
   \   0000025E   2B01                       OR      R16,R17
   \   00000260   F431                       BRNE    ??ledpr_31
   \   00000262   ....                       LDI     R30,LOW((hrem + 714))
   \   00000264   ....                       LDI     R31,(hrem + 714) >> 8
   \   00000266   8100                       LD      R16,Z
   \   00000268   8111                       LDD     R17,Z+1
   \   0000026A   2B01                       OR      R16,R17
   \   0000026C   F019                       BREQ    ??ledpr_32
   \                     ??ledpr_31:
   \   0000026E   98A8                       CBI     0x15,0x00
   \   00000270   9AA9                       SBI     0x15,0x01
   \   00000272   C010                       RJMP    ??ledpr_2
    206                          else 
    207                             if (((ramb[0x018]&4)!=0)||((chmaskout&4)!=0) ){ //неисправность шлейфа 3
   \                     ??ledpr_32:
   \   00000274   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000276   A900                       LDD     R16,Z+48
   \   00000278   FD02                       SBRC    R16,2
   \   0000027A   C005                       RJMP    ??ledpr_33
   \   0000027C   ....                       LDI     R30,LOW(chmaskout)
   \   0000027E   ....                       LDI     R31,(chmaskout) >> 8
   \   00000280   8100                       LD      R16,Z
   \   00000282   FF02                       SBRS    R16,2
   \   00000284   C005                       RJMP    ??ledpr_34
    208                                  if ((time&1024)==0){gr3=1;red3=0;}
   \                     ??ledpr_33:
   \   00000286   ....                       LDI     R30,LOW(time)
   \   00000288   ....                       LDI     R31,(time) >> 8
   \   0000028A   8101                       LDD     R16,Z+1
   \   0000028C   FD02                       SBRC    R16,2
   \   0000028E   CFEF                       RJMP    ??ledpr_31
    209                                  else {gr3=0;red3=1;}
    210                             }else {gr3=1;red3=0;}; //шлейф в норме
   \                     ??ledpr_34:
   \   00000290   9AA8                       SBI     0x15,0x00
   \   00000292   98A9                       CBI     0x15,0x01
   \                     ??ledpr_2:
   \   00000294   91A9                       LD      R26,Y+
   \   00000296   91B9                       LD      R27,Y+
   \   00000298   9508                       RET
    211                    
    212                  //  if((hrem[0x166]!=0)||(hrem[0x167]!=0)) {gr1=0;red1=1;}//тревога шлейфа 
    213                       //   else 
    214                       //      if (((ramb[0x018]&8)!=0)||((chmaskout&8)!=0) ){ //неисправность шлейфа 4
    215                              //    if ((time&1024)==0){gr4=1;}//red4=0;}
    216                              //    else {gr4=0;}//red4=1;}
    217                         //    }else {gr4=1;}//red4=0;}; //шлейф в норме
    218                    
    219          
    220          
    221                   }  
    222           }  
    223          }

   \                                 In segment CODE, align 2, keep-with-next
    224          chtime(){
   \                     chtime:
    225          static int timeold=0;
    226          int time2;
    227          _ID
   \   00000000   94F8                       CLI
    228            time2=time;
   \   00000002   ....                       LDI     R30,LOW(time)
   \   00000004   ....                       LDI     R31,(time) >> 8
   \   00000006   8120                       LD      R18,Z
   \   00000008   8131                       LDD     R19,Z+1
    229          _IE
   \   0000000A   9478                       SEI
    230          if  (hrem[0x178]==0xffff) hrem[0x178]=0;
   \   0000000C   ....                       LDI     R30,LOW((hrem + 752))
   \   0000000E   ....                       LDI     R31,(hrem + 752) >> 8
   \   00000010   8100                       LD      R16,Z
   \   00000012   8111                       LDD     R17,Z+1
   \   00000014   3F0F                       CPI     R16,255
   \   00000016   4F1F                       SBCI    R17,255
   \   00000018   F419                       BRNE    ??chtime_0
   \   0000001A   E000                       LDI     R16,0
   \   0000001C   8300                       ST      Z,R16
   \   0000001E   8301                       STD     Z+1,R16
    231          if (timeold<time2){
   \                     ??chtime_0:
   \   00000020   ....                       LDI     R30,LOW(??timeold)
   \   00000022   ....                       LDI     R31,(??timeold) >> 8
   \   00000024   8100                       LD      R16,Z
   \   00000026   8111                       LDD     R17,Z+1
   \   00000028   1702                       CP      R16,R18
   \   0000002A   0713                       CPC     R17,R19
   \   0000002C   F4CC                       BRGE    ??chtime_1
    232            if ((time2-timeold)>1) hrem[0x177]=time2-timeold;
   \   0000002E   01A8                       MOVW    R21 : R20,R17 : R16
   \   00000030   0189                       MOVW    R17 : R16,R19 : R18
   \   00000032   1B04                       SUB     R16,R20
   \   00000034   0B15                       SBC     R17,R21
   \   00000036   3002                       CPI     R16,2
   \   00000038   E040                       LDI     R20,0
   \   0000003A   0714                       CPC     R17,R20
   \   0000003C   F024                       BRLT    ??chtime_2
   \   0000003E   ....                       LDI     R30,LOW((hrem + 750))
   \   00000040   ....                       LDI     R31,(hrem + 750) >> 8
   \   00000042   8300                       ST      Z,R16
   \   00000044   8311                       STD     Z+1,R17
    233            if (hrem[0x177]>hrem[0x178]) hrem[0x178]=hrem[0x177];
   \                     ??chtime_2:
   \   00000046   ....                       LDI     R30,LOW((hrem + 750))
   \   00000048   ....                       LDI     R31,(hrem + 750) >> 8
   \   0000004A   8100                       LD      R16,Z
   \   0000004C   8111                       LDD     R17,Z+1
   \   0000004E   ....                       LDI     R30,LOW((hrem + 752))
   \   00000050   ....                       LDI     R31,(hrem + 752) >> 8
   \   00000052   8140                       LD      R20,Z
   \   00000054   8151                       LDD     R21,Z+1
   \   00000056   1740                       CP      R20,R16
   \   00000058   0751                       CPC     R21,R17
   \   0000005A   F410                       BRCC    ??chtime_1
   \   0000005C   8300                       ST      Z,R16
   \   0000005E   8311                       STD     Z+1,R17
    234            }
    235          timeold=time2;  
   \                     ??chtime_1:
   \   00000060   ....                       LDI     R30,LOW(??timeold)
   \   00000062   ....                       LDI     R31,(??timeold) >> 8
   \   00000064   8320                       ST      Z,R18
   \   00000066   8331                       STD     Z+1,R19
    236          }
   \   00000068   9508                       RET

   \                                 In segment CODE, align 2, keep-with-next
    237          void resalarm(){
   \                     resalarm:
   \   00000000   93BA                       ST      -Y,R27
   \   00000002   93AA                       ST      -Y,R26
   \   00000004   939A                       ST      -Y,R25
   \   00000006   938A                       ST      -Y,R24
    238          UINT adr,tmp;
    239          if (ramb[0x0f]==0)return;
   \   00000008   ....                       LDI     R26,LOW(ramb)
   \   0000000A   ....                       LDI     R27,(ramb) >> 8
   \   0000000C   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000000E   8D06                       LDD     R16,Z+30
   \   00000010   8D17                       LDD     R17,Z+31
   \   00000012   2B01                       OR      R16,R17
   \   00000014   F409                       BRNE    $+2+2
   \   00000016   C043                       RJMP    ??resalarm_0
    240          /*
    241          adr=((ramb[0x0f]&0x0300)>>7)+((ramb[0x0f]&0x1f)>>4);
    242          tmp=hrem[adr+0x160]&~(1<<(ramb[0x0f]&0x0f)-1);
    243          setrg(adr+0x160,tmp);
    244          tmp=hrem[adr+0x168]&~(1<<(ramb[0x0f]&0x0f)-1);
    245          setrg(adr+0x168,tmp);
    246          */
    247          adr=((ramb[0x0f]&0x0300)>>7)+(((ramb[0x0f]-1)&0x1f)>>4);
   \   00000018   8D46                       LDD     R20,Z+30
   \   0000001A   954A                       DEC     R20
   \   0000001C   E000                       LDI     R16,0
   \   0000001E   7013                       ANDI    R17,0x03
   \   00000020   0F00                       LSL     R16
   \   00000022   2F01                       MOV     R16,R17
   \   00000024   1F00                       ROL     R16
   \   00000026   2F84                       MOV     R24,R20
   \   00000028   718F                       ANDI    R24,0x1F
   \   0000002A   9582                       SWAP    R24
   \   0000002C   708F                       ANDI    R24,0x0F
   \   0000002E   E090                       LDI     R25,0
   \   00000030   0F80                       ADD     R24,R16
    248          tmp=hrem[adr+0x160]&~(1<<((ramb[0x0f]-1)&0x0f));
    249          setrg(adr+0x160,tmp);
   \   00000032   01BC                       MOVW    R23 : R22,R25 : R24
   \   00000034   5A60                       SUBI    R22,160
   \   00000036   4F7E                       SBCI    R23,254
   \   00000038   018B                       MOVW    R17 : R16,R23 : R22
   \   0000003A   0F00                       LSL     R16
   \   0000003C   1F11                       ROL     R17
   \   0000003E   01F8                       MOVW    R31 : R30,R17 : R16
   \   00000040   ....                       SUBI    R30,LOW((-(hrem) & 0xFFFF))
   \   00000042   ....                       SBCI    R31,(-(hrem) & 0xFFFF) >> 8
   \   00000044   8120                       LD      R18,Z
   \   00000046   8131                       LDD     R19,Z+1
   \   00000048   E001                       LDI     R16,1
   \   0000004A   E010                       LDI     R17,0
   \   0000004C   704F                       ANDI    R20,0x0F
   \   0000004E   ........                   CALL    ?S_SHL_L02
   \   00000052   9500                       COM     R16
   \   00000054   9510                       COM     R17
   \   00000056   2302                       AND     R16,R18
   \   00000058   2313                       AND     R17,R19
   \   0000005A   0198                       MOVW    R19 : R18,R17 : R16
   \   0000005C   018B                       MOVW    R17 : R16,R23 : R22
   \   0000005E   ........                   CALL    setrg
    250          tmp=hrem[adr+0x168]&~(1<<((ramb[0x0f]-1)&0x0f));
    251          setrg(adr+0x168,tmp);
   \   00000062   5988                       SUBI    R24,152
   \   00000064   4F9E                       SBCI    R25,254
   \   00000066   018C                       MOVW    R17 : R16,R25 : R24
   \   00000068   0F00                       LSL     R16
   \   0000006A   1F11                       ROL     R17
   \   0000006C   01F8                       MOVW    R31 : R30,R17 : R16
   \   0000006E   ....                       SUBI    R30,LOW((-(hrem) & 0xFFFF))
   \   00000070   ....                       SBCI    R31,(-(hrem) & 0xFFFF) >> 8
   \   00000072   8120                       LD      R18,Z
   \   00000074   8131                       LDD     R19,Z+1
   \   00000076   E001                       LDI     R16,1
   \   00000078   E010                       LDI     R17,0
   \   0000007A   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000007C   8D46                       LDD     R20,Z+30
   \   0000007E   954A                       DEC     R20
   \   00000080   704F                       ANDI    R20,0x0F
   \   00000082   ........                   CALL    ?S_SHL_L02
   \   00000086   9500                       COM     R16
   \   00000088   9510                       COM     R17
   \   0000008A   2302                       AND     R16,R18
   \   0000008C   2313                       AND     R17,R19
   \   0000008E   0198                       MOVW    R19 : R18,R17 : R16
   \   00000090   018C                       MOVW    R17 : R16,R25 : R24
   \   00000092   ........                   CALL    setrg
    252          /*
    253          addh(0x5555);
    254          addh(ramb[0x0f]);
    255          addh(adr);
    256          addh(tmp);
    257          */
    258          
    259          ramb[0x0f]=0;
   \   00000096   E000                       LDI     R16,0
   \   00000098   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000009A   8F06                       STD     Z+30,R16
   \   0000009C   8F07                       STD     Z+31,R16
    260          
    261          };
   \                     ??resalarm_0:
   \   0000009E   9189                       LD      R24,Y+
   \   000000A0   9199                       LD      R25,Y+
   \   000000A2   91A9                       LD      R26,Y+
   \   000000A4   91B9                       LD      R27,Y+
   \   000000A6   9508                       RET
    262          //функция проверки работоспособности модбаса
    263          #define maxcnt 10 //20c 

   \                                 In segment CODE, align 2, keep-with-next
    264          check_mb(){
   \                     check_mb:
   \   00000000   938A                       ST      -Y,R24
    265          static char cnt0=0,cnt1=0; //счетчики таймаутов на запросы
    266          char mbstate_copy; //st0,st1;
    267          
    268          _ID
   \   00000002   94F8                       CLI
    269           mbstate_copy=mbstate;
   \   00000004   9180....                   LDS     R24,mbstate
    270           mbstate=0;
   \   00000008   E000                       LDI     R16,0
   \   0000000A   9300....                   STS     mbstate,R16
    271          // st0=u0.state;
    272          // st1=u1.state;
    273           _IE 
   \   0000000E   9478                       SEI
    274           
    275            if (mbstate_copy&(1<<mbst0) ){// был запрос по мб
   \   00000010   FB80                       BST     R24,0
   \   00000012   F08E                       BRTS    ??check_mb_0
    276                cnt0=0;    
    277           }else  if (cnt0>maxcnt) {
   \   00000014   9100....                   LDS     R16,??cnt0
   \   00000018   300B                       CPI     R16,11
   \   0000001A   F078                       BRCS    ??check_mb_1
    278             initmb0(b_speed,b_parity,b_addr);cnt0=0;
   \   0000001C   ....                       LDI     R30,LOW((hrem + 514))
   \   0000001E   ....                       LDI     R31,(hrem + 514) >> 8
   \   00000020   8130                       LD      R19,Z
   \   00000022   ....                       LDI     R30,LOW((hrem + 518))
   \   00000024   ....                       LDI     R31,(hrem + 518) >> 8
   \   00000026   8120                       LD      R18,Z
   \   00000028   ....                       LDI     R30,LOW((hrem + 516))
   \   0000002A   ....                       LDI     R31,(hrem + 516) >> 8
   \   0000002C   8100                       LD      R16,Z
   \   0000002E   8111                       LDD     R17,Z+1
   \   00000030   ........                   CALL    initmb0
   \   00000034   E000                       LDI     R16,0
   \                     ??check_mb_0:
   \   00000036   9300....                   STS     ??cnt0,R16
    279          //   redon1;
    280          //   hrem[0x176]=cnt0;
    281           }
    282           
    283           if (dev_ver_r==0){
   \                     ??check_mb_1:
   \   0000003A   9987                       SBIC    0x10,0x07
   \   0000003C   C015                       RJMP    ??check_mb_2
    284               if (mbstate_copy&(1<<mbst1)){// был запрос по мб
   \   0000003E   FB81                       BST     R24,1
   \   00000040   F086                       BRTS    ??check_mb_3
    285                cnt1=0;    
    286               }else  if (cnt1>maxcnt) {
   \   00000042   9100....                   LDS     R16,(??cnt0 + 1)
   \   00000046   300B                       CPI     R16,11
   \   00000048   F078                       BRCS    ??check_mb_2
    287               initmb1(b_speed,b_parity,b_addr);cnt1=0;
   \   0000004A   ....                       LDI     R30,LOW((hrem + 514))
   \   0000004C   ....                       LDI     R31,(hrem + 514) >> 8
   \   0000004E   8130                       LD      R19,Z
   \   00000050   ....                       LDI     R30,LOW((hrem + 518))
   \   00000052   ....                       LDI     R31,(hrem + 518) >> 8
   \   00000054   8120                       LD      R18,Z
   \   00000056   ....                       LDI     R30,LOW((hrem + 516))
   \   00000058   ....                       LDI     R31,(hrem + 516) >> 8
   \   0000005A   8100                       LD      R16,Z
   \   0000005C   8111                       LDD     R17,Z+1
   \   0000005E   ........                   CALL    initmb1
   \                     ??check_mb_3:
   \   00000062   E000                       LDI     R16,0
   \   00000064   9300....                   STS     (??cnt0 + 1),R16
    288          //     redon2
    289          //     hrem[0x177]=cnt1;
    290               }
    291           }
    292           if(gettout(5)==0){
   \                     ??check_mb_2:
   \   00000068   E005                       LDI     R16,5
   \   0000006A   ........                   CALL    gettout
   \   0000006E   2300                       TST     R16
   \   00000070   F469                       BRNE    ??check_mb_4
    293            cnt0++;cnt1++; settout(5,1000); //red3^=1;
   \   00000072   ....                       LDI     R30,LOW(??cnt0)
   \   00000074   ....                       LDI     R31,(??cnt0) >> 8
   \   00000076   8100                       LD      R16,Z
   \   00000078   9503                       INC     R16
   \   0000007A   8300                       ST      Z,R16
   \   0000007C   8101                       LDD     R16,Z+1
   \   0000007E   9503                       INC     R16
   \   00000080   8301                       STD     Z+1,R16
   \   00000082   EE28                       LDI     R18,232
   \   00000084   E033                       LDI     R19,3
   \   00000086   E005                       LDI     R16,5
   \   00000088   ........                   CALL    settout
    294           }
    295           
    296           }
   \                     ??check_mb_4:
   \   0000008C   9189                       LD      R24,Y+
   \   0000008E   9508                       RET

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     tmv:
   \   00000000                              DS 2
   \                     t1:
   \   00000002                              DS 2
   \                     t2:
   \   00000004                              DS 2
   \                     t3:
   \   00000006                              DS 2
   \                     qwerty:
   \   00000008                              DS 2
   \                     t4:
   \   0000000A                              DS 2
   \                     t5:
   \   0000000C                              DS 2
    297          /*
    298          getstack()
    299                { char * st; int i;
    300                    st=(char*)hrem[0x10];
    301                    for (i=1;i<0x80;i++){hrem[i+0x10]=*st; st--;}
    302                };    
    303          */
    304          char firston;
   \                     firston:
   \   0000000E                              DS 1

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     inn:
   \   00000000                              DS 2

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     k:
   \   00000000                              DS 2

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     mmm:
   \   00000000                              DS 2

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     ledstate:
   \   00000000                              DS 1

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     ??timeold:
   \   00000000                              DS 2

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
   \                     ??cnt0:
   \   00000000                              DS 1
   \   00000001                              DS 1

   \                                 In segment CODE, align 2, keep-with-next
    305          main(){
   \                     main:
   \   00000000   925A                       ST      -Y,R5
   \   00000002   924A                       ST      -Y,R4
   \   00000004   93BA                       ST      -Y,R27
   \   00000006   93AA                       ST      -Y,R26
   \   00000008   939A                       ST      -Y,R25
   \   0000000A   938A                       ST      -Y,R24
   \   0000000C                              REQUIRE ?Register_R4_is_cg_reg
   \   0000000C                              REQUIRE ?Register_R5_is_cg_reg
    306                   
    307          
    308          __disable_interrupt();
   \   0000000C   94F8                       CLI
    309          WDTCR |= (1<<WDCE);
   \   0000000E   B501                       IN      R16,0x21
   \   00000010   6100                       ORI     R16,0x10
   \   00000012   BD01                       OUT     0x21,R16
    310          WDTCR |= (1<<WDP0) | (1<<WDP1) | (1<<WDP2);
   \   00000014   B501                       IN      R16,0x21
   \   00000016   6007                       ORI     R16,0x07
   \   00000018   BD01                       OUT     0x21,R16
    311          __enable_interrupt();
   \   0000001A   9478                       SEI
    312          
    313          iniports();
   \   0000001C   ....                       RCALL   iniports
    314          redonw 
   \   0000001E   9AAF                       SBI     0x15,0x07
    315          //redon1 redon2 redon3 redon4;
    316          inibase();
   \   00000020   ........                   CALL    inibase
    317          if (basechk()) dev_status|=1<<8;
   \   00000024   ........                   CALL    basechk
   \   00000028   2B01                       OR      R16,R17
   \   0000002A   F029                       BREQ    ??main_0
   \   0000002C   ....                       LDI     R30,LOW(ramb)
   \   0000002E   ....                       LDI     R31,(ramb) >> 8
   \   00000030   A901                       LDD     R16,Z+49
   \   00000032   6001                       ORI     R16,0x01
   \   00000034   AB01                       STD     Z+49,R16
    318          //v_status|=1<<8;
    319          initime();
   \                     ??main_0:
   \   00000036   ........                   CALL    initime
    320          inihist(0xa1,0xff);
   \   0000003A   EF2F                       LDI     R18,255
   \   0000003C   E030                       LDI     R19,0
   \   0000003E   EA01                       LDI     R16,161
   \   00000040   E010                       LDI     R17,0
   \   00000042   ........                   CALL    inihist
    321          __disable_interrupt();
   \   00000046   94F8                       CLI
    322          WDTCR |= (1<<WDCE);
   \   00000048   B501                       IN      R16,0x21
   \   0000004A   6100                       ORI     R16,0x10
   \   0000004C   BD01                       OUT     0x21,R16
    323          WDTCR |= (1<<WDP0) | (1<<WDP1) | (1<<WDP2);
   \   0000004E   B501                       IN      R16,0x21
   \   00000050   6007                       ORI     R16,0x07
   \   00000052   BD01                       OUT     0x21,R16
    324          __enable_interrupt();
   \   00000054   9478                       SEI
    325          
    326          /**************************/
    327           Init();
   \   00000056   ........                   CALL    Init
    328          /**************************/
    329          
    330          
    331          if(xk1==0) inicomm(); // при установленной перемычке инициируем связь 
   \   0000005A   91100063                   LDS     R17,99
   \   0000005E   FD13                       SBRC    R17,3
   \   00000060   C002                       RJMP    ??main_1
   \   00000062   ........                   CALL    inicomm
    332                                //переменными по умолчанию.
    333          
    334          DDRE_Bit2 =1; //бит управления печкой на вывод    
   \                     ??main_1:
   \   00000066   9A12                       SBI     0x02,0x02
    335          PORTE_Bit2 = 0; // отключили печку
   \   00000068   981A                       CBI     0x03,0x02
    336          initmb0(b_speed,b_parity,b_addr);
   \   0000006A   ....                       LDI     R30,LOW((hrem + 514))
   \   0000006C   ....                       LDI     R31,(hrem + 514) >> 8
   \   0000006E   8130                       LD      R19,Z
   \   00000070   ....                       LDI     R30,LOW((hrem + 518))
   \   00000072   ....                       LDI     R31,(hrem + 518) >> 8
   \   00000074   8120                       LD      R18,Z
   \   00000076   ....                       LDI     R30,LOW((hrem + 516))
   \   00000078   ....                       LDI     R31,(hrem + 516) >> 8
   \   0000007A   8100                       LD      R16,Z
   \   0000007C   8111                       LDD     R17,Z+1
   \   0000007E   ........                   CALL    initmb0
    337          if (dev_ver_r==0) initmb1(b_speed,b_parity,b_addr);
   \   00000082   9987                       SBIC    0x10,0x07
   \   00000084   C00C                       RJMP    ??main_2
   \   00000086   ....                       LDI     R30,LOW((hrem + 514))
   \   00000088   ....                       LDI     R31,(hrem + 514) >> 8
   \   0000008A   8130                       LD      R19,Z
   \   0000008C   ....                       LDI     R30,LOW((hrem + 518))
   \   0000008E   ....                       LDI     R31,(hrem + 518) >> 8
   \   00000090   8120                       LD      R18,Z
   \   00000092   ....                       LDI     R30,LOW((hrem + 516))
   \   00000094   ....                       LDI     R31,(hrem + 516) >> 8
   \   00000096   8100                       LD      R16,Z
   \   00000098   8111                       LDD     R17,Z+1
   \   0000009A   ........                   CALL    initmb1
    338          
    339          
    340          __watchdog_reset();
   \                     ??main_2:
   \   0000009E   95A8                       WDR
    341          //setrg(0x176,++hrem[0x176]);
    342          if (dev_ver_heat==0) { //исполнение с печкой и датчиком температуры
   \   000000A0   9986                       SBIC    0x10,0x06
   \   000000A2   C016                       RJMP    ??main_3
    343          //    addh(0x333);
    344              if(isempty(temp_id_adr)){
   \   000000A4   E700                       LDI     R16,112
   \   000000A6   E011                       LDI     R17,1
   \   000000A8   ........                   CALL    isempty
   \   000000AC   2300                       TST     R16
   \   000000AE   F081                       BREQ    ??main_3
    345          //          addh(0x444); 
    346                    if (get_temp_id()!=0) {dev_status |=0x200;}//проблемы с получением ID датчика
   \   000000B0   ........                   CALL    get_temp_id
   \   000000B4   2300                       TST     R16
   \   000000B6   F031                       BREQ    ??main_4
   \   000000B8   ....                       LDI     R30,LOW(ramb)
   \   000000BA   ....                       LDI     R31,(ramb) >> 8
   \   000000BC   A901                       LDD     R16,Z+49
   \   000000BE   6002                       ORI     R16,0x02
   \   000000C0   AB01                       STD     Z+49,R16
   \   000000C2   C006                       RJMP    ??main_3
    347                    else setrg(0x174,-37*2);//setrg(0x174,-35*2);
   \                     ??main_4:
   \   000000C4   EB26                       LDI     R18,182
   \   000000C6   EF3F                       LDI     R19,255
   \   000000C8   E704                       LDI     R16,116
   \   000000CA   E011                       LDI     R17,1
   \   000000CC   ........                   CALL    setrg
    348              }
    349          }             
    350          
    351          
    352          
    353          
    354          delayloop(50);    
   \                     ??main_3:
   \   000000D0   E302                       LDI     R16,50
   \   000000D2   E010                       LDI     R17,0
   \   000000D4   ....                       RCALL   delayloop
    355          off4 off3 off2 off1 offw
   \   000000D6   91000065                   LDS     R16,101
   \   000000DA   7F0E                       ANDI    R16,0xFE
   \   000000DC   93000065                   STS     101,R16
   \   000000E0   7F0D                       ANDI    R16,0xFD
   \   000000E2   93000065                   STS     101,R16
   \   000000E6   B305                       IN      R16,0x15
   \   000000E8   7F0C                       ANDI    R16,0xFC
   \   000000EA   BB05                       OUT     0x15,R16
   \   000000EC   B305                       IN      R16,0x15
   \   000000EE   7F03                       ANDI    R16,0xF3
   \   000000F0   BB05                       OUT     0x15,R16
   \   000000F2   B305                       IN      R16,0x15
   \   000000F4   7C0F                       ANDI    R16,0xCF
   \   000000F6   BB05                       OUT     0x15,R16
   \   000000F8   B305                       IN      R16,0x15
   \   000000FA   730F                       ANDI    R16,0x3F
   \   000000FC   BB05                       OUT     0x15,R16
    356          qwerty=1900;//начальная продолжительность нагрева(2000-1900=100 мс)
   \   000000FE   ....                       LDI     R26,LOW(tmv)
   \   00000100   ....                       LDI     R27,(tmv) >> 8
   \   00000102   E60C                       LDI     R16,108
   \   00000104   E017                       LDI     R17,7
   \   00000106   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000108   8700                       STD     Z+8,R16
   \   0000010A   8711                       STD     Z+9,R17
    357          
    358          if ((hrem[0x380]>>8)>3){qwerty=1900-200*((hrem[0x380]>>8)/3);}//корректировка начальной продолжительности нагрева в периоде в зависимости от скорости нарастания температуры
   \   0000010C   ....                       LDI     R30,LOW((hrem + 1792))
   \   0000010E   ....                       LDI     R31,(hrem + 1792) >> 8
   \   00000110   8101                       LDD     R16,Z+1
   \   00000112   3004                       CPI     R16,4
   \   00000114   F078                       BRCS    ??main_5
   \   00000116   E68C                       LDI     R24,108
   \   00000118   E097                       LDI     R25,7
   \   0000011A   E043                       LDI     R20,3
   \   0000011C   ........                   CALL    ?UC_DIVMOD_L01
   \   00000120   2F20                       MOV     R18,R16
   \   00000122   E030                       LDI     R19,0
   \   00000124   EC08                       LDI     R16,200
   \   00000126   9F03                       MUL     R16,R19
   \   00000128   9F02                       MUL     R16,R18
   \   0000012A   1980                       SUB     R24,R0
   \   0000012C   0991                       SBC     R25,R1
   \   0000012E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000130   8780                       STD     Z+8,R24
   \   00000132   8791                       STD     Z+9,R25
    359          tmv=0;t5=1;
   \                     ??main_5:
   \   00000134   E000                       LDI     R16,0
   \   00000136   E010                       LDI     R17,0
   \   00000138   930D                       ST      X+,R16
   \   0000013A   930C                       ST      X,R16
   \   0000013C   9711                       SBIW    R27 : R26,1
   \   0000013E   E001                       LDI     R16,1
   \   00000140   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000142   8704                       STD     Z+12,R16
   \   00000144   8715                       STD     Z+13,R17
   \   00000146   C005                       RJMP    ??main_6
    360          qwer:
    361          settout(6,qwerty);firston=0;settout(7,2000);//задаем таймауты
    362          for (;;){//int ii;
    363          
    364            __watchdog_reset();
    365            if(ramb[0x19]==0xffff){
    366              if(dev_status&0x8000)config_uLan();
    367              else { dev_status|=0x8000;lineflags=0;config_uLan();}
    368            }else {dev_status&=~0x8000; GetT();};
    369          
    370          __watchdog_reset();
    371            if (res_fl!=0)for(;;); //отработка сброса
    372            if (u0.addr!=hrem[0x101]){//отложенная обработка установки адреса устройства
    373               setrg(0x101,u0.addr);
    374            } 
    375          // for(ii=0;ii<100;ii++) __delay_cycles(15*1000);
    376          //getstack();
    377          //__watchdog_reset();
    378          //mbdiagn();
    379            __watchdog_reset();
    380          //chtime();
    381          
    382            check_mb();
    383            __watchdog_reset();
    384            ledpr();
    385             __watchdog_reset();
    386            wrblock();
    387            __watchdog_reset();
    388            resalarm();
    389          
    390          
    391          if (((ramb[0x20]>>1)>=50)&&(t5==1)) {qwerty=700;t5=0;}
    392          if (((ramb[0x20]>>1)>=60)&&(t5==1)) {qwerty=300;t5=0;}
    393          
    394          if (tmv==0){t1=(ramb[0x20]>>1);t3=(hrem[0x380]>>8);}
    395          if ((tmv==5)||(tmv==10)){t2=(ramb[0x20]>>1); t4=(hrem[0x380]>>8); if ((t2-t1)<-2){qwerty=2000;} if ((t4-t3)!=0){qwerty=qwerty-100*(t4-t3);t3=(hrem[0x380]>>8);}//Анализ положения двери
    396          }
    397          if (tmv==10){t2=(ramb[0x20]>>1);if ((t2-t1)>((hrem[0x380]>>8)/3)){qwerty=qwerty+100;}//уменьшаем продолжительность нагрева в периоде
    398          if (((t2-t1)<((hrem[0x380]>>8)/3))&&((ramb[0x20]>>1)!=(hrem[0x380] & 0x00ff))&&((t2-t1)>-2)&&(((ramb[0x20]>>1)-1)!=(hrem[0x380] & 0x00ff))&&(((ramb[0x20]>>1)+1)!=(hrem[0x380] & 0x00ff))){t5=0;if(((hrem[0x380]>>8)/3)-(t2-t1)>1){qwerty=qwerty-200;} else {qwerty=qwerty-100;}}//увеличиваем продолжительность нагрева в периоде
    399          if(qwerty<0){qwerty=0;}
    400          tmv=0;}
    401          gr1=1;
    402                 if ((ramb[0x20]>>1) >= (hrem[0x380] & 0x00ff) ) {
    403                 heaton; red1=0;gr1=1;firston=0;goto qwer;}//выключили печку
   \                     ??main_7:
   \   00000148   9A1A                       SBI     0x03,0x02
   \   0000014A   98AD                       CBI     0x15,0x05
   \   0000014C   9AAC                       SBI     0x15,0x04
   \   0000014E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000150   8716                       STD     Z+14,R17
   \                     ??main_6:
   \   00000152   8520                       LDD     R18,Z+8
   \   00000154   8531                       LDD     R19,Z+9
   \   00000156   E006                       LDI     R16,6
   \   00000158   ........                   CALL    settout
   \   0000015C   E000                       LDI     R16,0
   \   0000015E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000160   8706                       STD     Z+14,R16
   \   00000162   ED20                       LDI     R18,208
   \   00000164   E037                       LDI     R19,7
   \   00000166   E007                       LDI     R16,7
   \   00000168   ........                   CALL    settout
   \                     ??main_8:
   \   0000016C   95A8                       WDR
   \   0000016E   ....                       LDI     R30,LOW(ramb)
   \   00000170   ....                       LDI     R31,(ramb) >> 8
   \   00000172   A902                       LDD     R16,Z+50
   \   00000174   A913                       LDD     R17,Z+51
   \   00000176   3F0F                       CPI     R16,255
   \   00000178   4F1F                       SBCI    R17,255
   \   0000017A   A901                       LDD     R16,Z+49
   \   0000017C   F459                       BRNE    ??main_9
   \   0000017E   FF07                       SBRS    R16,7
   \   00000180   C003                       RJMP    ??main_10
   \                     ??main_11:
   \   00000182   ........                   CALL    config_uLan
   \   00000186   C00A                       RJMP    ??main_12
   \                     ??main_10:
   \   00000188   6800                       ORI     R16,0x80
   \   0000018A   AB01                       STD     Z+49,R16
   \   0000018C   E000                       LDI     R16,0
   \   0000018E   9300....                   STS     lineflags,R16
   \   00000192   CFF7                       RJMP    ??main_11
   \                     ??main_9:
   \   00000194   770F                       ANDI    R16,0x7F
   \   00000196   AB01                       STD     Z+49,R16
   \   00000198   ........                   CALL    GetT
   \                     ??main_12:
   \   0000019C   95A8                       WDR
   \   0000019E   9100....                   LDS     R16,res_fl
   \   000001A2   2300                       TST     R16
   \   000001A4   F009                       BREQ    ??main_13
   \                     ??main_14:
   \   000001A6   CFFF                       RJMP    ??main_14
   \                     ??main_13:
   \   000001A8   9120....                   LDS     R18,(u0 + 3)
   \   000001AC   E030                       LDI     R19,0
   \   000001AE   ....                       LDI     R30,LOW((hrem + 514))
   \   000001B0   ....                       LDI     R31,(hrem + 514) >> 8
   \   000001B2   8100                       LD      R16,Z
   \   000001B4   8111                       LDD     R17,Z+1
   \   000001B6   1720                       CP      R18,R16
   \   000001B8   0731                       CPC     R19,R17
   \   000001BA   F021                       BREQ    ??main_15
   \   000001BC   E001                       LDI     R16,1
   \   000001BE   E011                       LDI     R17,1
   \   000001C0   ........                   CALL    setrg
   \                     ??main_15:
   \   000001C4   95A8                       WDR
   \   000001C6   ....                       RCALL   check_mb
   \   000001C8   95A8                       WDR
   \   000001CA   ....                       RCALL   ledpr
   \   000001CC   95A8                       WDR
   \   000001CE   ........                   CALL    wrblock
   \   000001D2   95A8                       WDR
   \   000001D4   ....                       RCALL   resalarm
   \   000001D6   ....                       LDI     R30,LOW((ramb + 64))
   \   000001D8   ....                       LDI     R31,(ramb + 64) >> 8
   \   000001DA   8180                       LD      R24,Z
   \   000001DC   8191                       LDD     R25,Z+1
   \   000001DE   9596                       LSR     R25
   \   000001E0   9587                       ROR     R24
   \   000001E2   3382                       CPI     R24,50
   \   000001E4   E000                       LDI     R16,0
   \   000001E6   0790                       CPC     R25,R16
   \   000001E8   F068                       BRCS    ??main_16
   \   000001EA   01FD                       MOVW    R31 : R30,R27 : R26
   \   000001EC   8504                       LDD     R16,Z+12
   \   000001EE   8515                       LDD     R17,Z+13
   \   000001F0   3001                       CPI     R16,1
   \   000001F2   E020                       LDI     R18,0
   \   000001F4   4010                       SBCI    R17,0
   \   000001F6   F431                       BRNE    ??main_16
   \   000001F8   EB0C                       LDI     R16,188
   \   000001FA   E012                       LDI     R17,2
   \   000001FC   8700                       STD     Z+8,R16
   \   000001FE   8711                       STD     Z+9,R17
   \   00000200   8724                       STD     Z+12,R18
   \   00000202   8725                       STD     Z+13,R18
   \                     ??main_16:
   \   00000204   338C                       CPI     R24,60
   \   00000206   E000                       LDI     R16,0
   \   00000208   0790                       CPC     R25,R16
   \   0000020A   F068                       BRCS    ??main_17
   \   0000020C   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000020E   8504                       LDD     R16,Z+12
   \   00000210   8515                       LDD     R17,Z+13
   \   00000212   3001                       CPI     R16,1
   \   00000214   E020                       LDI     R18,0
   \   00000216   4010                       SBCI    R17,0
   \   00000218   F431                       BRNE    ??main_17
   \   0000021A   E20C                       LDI     R16,44
   \   0000021C   E011                       LDI     R17,1
   \   0000021E   8700                       STD     Z+8,R16
   \   00000220   8711                       STD     Z+9,R17
   \   00000222   8724                       STD     Z+12,R18
   \   00000224   8725                       STD     Z+13,R18
   \                     ??main_17:
   \   00000226   910D                       LD      R16,X+
   \   00000228   911C                       LD      R17,X
   \   0000022A   9711                       SBIW    R27 : R26,1
   \   0000022C   2B01                       OR      R16,R17
   \   0000022E   F459                       BRNE    ??main_18
   \   00000230   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000232   8382                       STD     Z+2,R24
   \   00000234   8393                       STD     Z+3,R25
   \   00000236   ....                       LDI     R30,LOW((hrem + 1792))
   \   00000238   ....                       LDI     R31,(hrem + 1792) >> 8
   \   0000023A   8101                       LDD     R16,Z+1
   \   0000023C   E010                       LDI     R17,0
   \   0000023E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000240   8306                       STD     Z+6,R16
   \   00000242   8317                       STD     Z+7,R17
   \   00000244   C088                       RJMP    ??main_19
   \                     ??main_18:
   \   00000246   910D                       LD      R16,X+
   \   00000248   9711                       SBIW    R27 : R26,1
   \   0000024A   3005                       CPI     R16,5
   \   0000024C   E020                       LDI     R18,0
   \   0000024E   0712                       CPC     R17,R18
   \   00000250   F029                       BREQ    ??main_20
   \   00000252   910D                       LD      R16,X+
   \   00000254   9711                       SBIW    R27 : R26,1
   \   00000256   300A                       CPI     R16,10
   \   00000258   0712                       CPC     R17,R18
   \   0000025A   F569                       BRNE    ??main_21
   \                     ??main_20:
   \   0000025C   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000025E   8384                       STD     Z+4,R24
   \   00000260   8395                       STD     Z+5,R25
   \   00000262   ....                       LDI     R30,LOW((hrem + 1792))
   \   00000264   ....                       LDI     R31,(hrem + 1792) >> 8
   \   00000266   8131                       LDD     R19,Z+1
   \   00000268   2F23                       MOV     R18,R19
   \   0000026A   E030                       LDI     R19,0
   \   0000026C   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000026E   8722                       STD     Z+10,R18
   \   00000270   8733                       STD     Z+11,R19
   \   00000272   018C                       MOVW    R17 : R16,R25 : R24
   \   00000274   8142                       LDD     R20,Z+2
   \   00000276   8153                       LDD     R21,Z+3
   \   00000278   1B04                       SUB     R16,R20
   \   0000027A   0B15                       SBC     R17,R21
   \   0000027C   3F0E                       CPI     R16,254
   \   0000027E   4F1F                       SBCI    R17,255
   \   00000280   F424                       BRGE    ??main_22
   \   00000282   ED00                       LDI     R16,208
   \   00000284   E017                       LDI     R17,7
   \   00000286   8700                       STD     Z+8,R16
   \   00000288   8711                       STD     Z+9,R17
   \                     ??main_22:
   \   0000028A   2F42                       MOV     R20,R18
   \   0000028C   E050                       LDI     R21,0
   \   0000028E   8106                       LDD     R16,Z+6
   \   00000290   8117                       LDD     R17,Z+7
   \   00000292   1B40                       SUB     R20,R16
   \   00000294   0B51                       SBC     R21,R17
   \   00000296   2F04                       MOV     R16,R20
   \   00000298   2B05                       OR      R16,R21
   \   0000029A   F069                       BREQ    ??main_21
   \   0000029C   E604                       LDI     R16,100
   \   0000029E   9F05                       MUL     R16,R21
   \   000002A0   2D10                       MOV     R17,R0
   \   000002A2   9F04                       MUL     R16,R20
   \   000002A4   0D11                       ADD     R17,R1
   \   000002A6   8540                       LDD     R20,Z+8
   \   000002A8   8551                       LDD     R21,Z+9
   \   000002AA   1940                       SUB     R20,R0
   \   000002AC   0B51                       SBC     R21,R17
   \   000002AE   8740                       STD     Z+8,R20
   \   000002B0   8751                       STD     Z+9,R21
   \   000002B2   8326                       STD     Z+6,R18
   \   000002B4   8337                       STD     Z+7,R19
   \                     ??main_21:
   \   000002B6   910D                       LD      R16,X+
   \   000002B8   911C                       LD      R17,X
   \   000002BA   9711                       SBIW    R27 : R26,1
   \   000002BC   300A                       CPI     R16,10
   \   000002BE   4010                       SBCI    R17,0
   \   000002C0   F009                       BREQ    $+2+2
   \   000002C2   C049                       RJMP    ??main_19
   \   000002C4   01FD                       MOVW    R31 : R30,R27 : R26
   \   000002C6   8384                       STD     Z+4,R24
   \   000002C8   8395                       STD     Z+5,R25
   \   000002CA   ....                       LDI     R30,LOW((hrem + 1792))
   \   000002CC   ....                       LDI     R31,(hrem + 1792) >> 8
   \   000002CE   8040                       LD      R4,Z
   \   000002D0   8051                       LDD     R5,Z+1
   \   000002D2   2D05                       MOV     R16,R5
   \   000002D4   E043                       LDI     R20,3
   \   000002D6   ........                   CALL    ?UC_DIVMOD_L01
   \   000002DA   E010                       LDI     R17,0
   \   000002DC   01FD                       MOVW    R31 : R30,R27 : R26
   \   000002DE   01BC                       MOVW    R23 : R22,R25 : R24
   \   000002E0   8122                       LDD     R18,Z+2
   \   000002E2   8133                       LDD     R19,Z+3
   \   000002E4   1B62                       SUB     R22,R18
   \   000002E6   0B73                       SBC     R23,R19
   \   000002E8   1706                       CP      R16,R22
   \   000002EA   0717                       CPC     R17,R23
   \   000002EC   F428                       BRCC    ??main_23
   \   000002EE   8500                       LDD     R16,Z+8
   \   000002F0   8511                       LDD     R17,Z+9
   \   000002F2   590C                       SUBI    R16,156
   \   000002F4   4F1F                       SBCI    R17,255
   \   000002F6   C023                       RJMP    ??main_24
   \                     ??main_23:
   \   000002F8   1760                       CP      R22,R16
   \   000002FA   0771                       CPC     R23,R17
   \   000002FC   F510                       BRCC    ??main_25
   \   000002FE   1584                       CP      R24,R4
   \   00000300   0791                       CPC     R25,R17
   \   00000302   F0F9                       BREQ    ??main_25
   \   00000304   3F6F                       CPI     R22,255
   \   00000306   EF4F                       LDI     R20,255
   \   00000308   0774                       CPC     R23,R20
   \   0000030A   F0DC                       BRLT    ??main_25
   \   0000030C   01AC                       MOVW    R21 : R20,R25 : R24
   \   0000030E   5041                       SUBI    R20,1
   \   00000310   4050                       SBCI    R21,0
   \   00000312   1544                       CP      R20,R4
   \   00000314   4050                       SBCI    R21,0
   \   00000316   F0A9                       BREQ    ??main_25
   \   00000318   01AC                       MOVW    R21 : R20,R25 : R24
   \   0000031A   5F4F                       SUBI    R20,255
   \   0000031C   4F5F                       SBCI    R21,255
   \   0000031E   1544                       CP      R20,R4
   \   00000320   4050                       SBCI    R21,0
   \   00000322   F079                       BREQ    ??main_25
   \   00000324   8714                       STD     Z+12,R17
   \   00000326   8715                       STD     Z+13,R17
   \   00000328   1B06                       SUB     R16,R22
   \   0000032A   0B17                       SBC     R17,R23
   \   0000032C   3002                       CPI     R16,2
   \   0000032E   4010                       SBCI    R17,0
   \   00000330   8500                       LDD     R16,Z+8
   \   00000332   8511                       LDD     R17,Z+9
   \   00000334   F010                       BRCS    ??main_26
   \   00000336   5C08                       SUBI    R16,200
   \   00000338   C001                       RJMP    ??main_27
   \                     ??main_26:
   \   0000033A   5604                       SUBI    R16,100
   \                     ??main_27:
   \   0000033C   4010                       SBCI    R17,0
   \                     ??main_24:
   \   0000033E   8700                       STD     Z+8,R16
   \   00000340   8711                       STD     Z+9,R17
   \                     ??main_25:
   \   00000342   8511                       LDD     R17,Z+9
   \   00000344   2311                       TST     R17
   \   00000346   F41A                       BRPL    ??main_28
   \   00000348   E000                       LDI     R16,0
   \   0000034A   8700                       STD     Z+8,R16
   \   0000034C   8701                       STD     Z+9,R16
   \                     ??main_28:
   \   0000034E   E000                       LDI     R16,0
   \   00000350   930D                       ST      X+,R16
   \   00000352   930C                       ST      X,R16
   \   00000354   9711                       SBIW    R27 : R26,1
   \                     ??main_19:
   \   00000356   9AAC                       SBI     0x15,0x04
   \   00000358   ....                       LDI     R30,LOW((hrem + 1792))
   \   0000035A   ....                       LDI     R31,(hrem + 1792) >> 8
   \   0000035C   8100                       LD      R16,Z
   \   0000035E   E010                       LDI     R17,0
   \   00000360   1780                       CP      R24,R16
   \   00000362   0791                       CPC     R25,R17
   \   00000364   F008                       BRCS    $+2+2
   \   00000366   CEF0                       RJMP    ??main_7
    404                 else {
    405              if (!gettout(6)&&(!firston))  { heatoff;red1=1;gr1=1;}//включили, ШИМ
   \   00000368   E006                       LDI     R16,6
   \   0000036A   ........                   CALL    gettout
   \   0000036E   2300                       TST     R16
   \   00000370   F439                       BRNE    ??main_29
   \   00000372   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000374   8506                       LDD     R16,Z+14
   \   00000376   2300                       TST     R16
   \   00000378   F419                       BRNE    ??main_29
   \   0000037A   981A                       CBI     0x03,0x02
   \   0000037C   9AAD                       SBI     0x15,0x05
   \   0000037E   9AAC                       SBI     0x15,0x04
    406          if (!gettout(7)){ firston=1;heaton; red1=0;gr1=1; tmv=tmv+1;  goto qwer;}      
   \                     ??main_29:
   \   00000380   E007                       LDI     R16,7
   \   00000382   ........                   CALL    gettout
   \   00000386   2300                       TST     R16
   \   00000388   F009                       BREQ    $+2+2
   \   0000038A   CEF0                       RJMP    ??main_8
   \   0000038C   E001                       LDI     R16,1
   \   0000038E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000390   8706                       STD     Z+14,R16
   \   00000392   9A1A                       SBI     0x03,0x02
   \   00000394   98AD                       CBI     0x15,0x05
   \   00000396   9AAC                       SBI     0x15,0x04
   \   00000398   910D                       LD      R16,X+
   \   0000039A   911C                       LD      R17,X
   \   0000039C   5F0F                       SUBI    R16,255
   \   0000039E   4F1F                       SBCI    R17,255
   \   000003A0   931C                       ST      X,R17
   \   000003A2   930E                       ST      -X,R16
   \   000003A4   CED6                       RJMP    ??main_6
    407          
    408            }     
    409          
    410          }};

   \                                 In segment ABSOLUTE, at 0x95
   \   union <unnamed> volatile __io _A_UCSR0C
   \                     _A_UCSR0C:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x65
   \   union <unnamed> volatile __io _A_PORTG
   \                     _A_PORTG:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x64
   \   union <unnamed> volatile __io _A_DDRG
   \                     _A_DDRG:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x63
   \   union <unnamed> volatile __io _A_PING
   \                     _A_PING:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x57
   \   union <unnamed> volatile __io _A_TIMSK
   \                     _A_TIMSK:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x56
   \   union <unnamed> volatile __io _A_TIFR
   \                     _A_TIFR:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x41
   \   union <unnamed> volatile __io _A_WDTCR
   \                     _A_WDTCR:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x3b
   \   union <unnamed> volatile __io _A_PORTA
   \                     _A_PORTA:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x38
   \   union <unnamed> volatile __io _A_PORTB
   \                     _A_PORTB:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x35
   \   union <unnamed> volatile __io _A_PORTC
   \                     _A_PORTC:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x34
   \   union <unnamed> volatile __io _A_DDRC
   \                     _A_DDRC:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x32
   \   union <unnamed> volatile __io _A_PORTD
   \                     _A_PORTD:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x30
   \   union <unnamed> volatile __io _A_PIND
   \                     _A_PIND:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x2a
   \   union <unnamed> volatile __io _A_UCSR0B
   \                     _A_UCSR0B:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x23
   \   union <unnamed> volatile __io _A_PORTE
   \                     _A_PORTE:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x22
   \   union <unnamed> volatile __io _A_DDRE
   \                     _A_DDRE:
   \   00000000                              DS 1
    411          
    412          

   Maximum stack usage in bytes:

     Function         CSTACK RSTACK
     --------         ------ ------
     check_mb             1      2
       -> initmb0         1      2
       -> initmb1         1      2
       -> gettout         1      2
       -> settout         1      2
     chtime               0      2
     delayloop            0      2
     iniports             0      2
     ledpr                2      2
       -> settout         2      2
       -> gettout         2      2
       -> settout         2      2
       -> settout         2      2
       -> settout         2      2
       -> settout         2      2
       -> gettout         2      2
       -> settout         2      2
       -> settout         2      2
       -> gettout         2      2
     main                 6      4
       -> iniports        6      2
       -> inibase         6      2
       -> basechk         6      2
       -> initime         6      2
       -> inihist         6      2
       -> Init            6      2
       -> inicomm         6      2
       -> initmb0         6      2
       -> initmb1         6      2
       -> isempty         6      2
       -> get_temp_id     6      2
       -> setrg           6      2
       -> delayloop       6      2
       -> settout         6      2
       -> settout         6      2
       -> config_uLan     6      2
       -> config_uLan     6      2
       -> GetT            6      2
       -> setrg           6      2
       -> check_mb        6      2
       -> ledpr           6      2
       -> wrblock         6      2
       -> resalarm        6      2
       -> gettout         6      2
       -> gettout         6      2
     mbdiagn              0      2
     resalarm             4      4
       -> setrg           4      2
       -> setrg           4      2


   Segment part sizes:

     Function/Label Bytes
     -------------- -----
     mbdiagn         198
     delayloop        32
     iniports         42
     ledpr           666
     chtime          106
     resalarm        168
     check_mb        144
     tmv              15
     inn               2
     k                 2
     mmm               2
     ledstate          1
     timeold           2
     cnt0              2
     main            934
     _A_UCSR0C         1
     _A_PORTG          1
     _A_DDRG           1
     _A_PING           1
     _A_TIMSK          1
     _A_TIFR           1
     _A_WDTCR          1
     _A_PORTA          1
     _A_PORTB          1
     _A_PORTC          1
     _A_DDRC           1
     _A_PORTD          1
     _A_PIND           1
     _A_UCSR0B         1
     _A_PORTE          1
     _A_DDRE           1
      Others           7

 
    16 bytes in segment ABSOLUTE
 2 290 bytes in segment CODE
     7 bytes in segment INITTAB
    26 bytes in segment NEAR_Z
 
 2 290 bytes of CODE memory (+  7 bytes shared)
    26 bytes of DATA memory (+ 16 bytes shared)

Errors: none
Warnings: 1
