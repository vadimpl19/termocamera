        UINT get_sp();
     20          
     21          
     22          
     23          

   \                                 In segment CODE, align 2, keep-with-next
     24          void delayloop(unsigned int d){
   \                     delayloop:
     25          unsigned int i,i2;
     26          for (i=0;i<d;i++)
   \   00000000   2F20                       MOV     R18,R16
   \   00000002   2B21                       OR      R18,R17
   \   00000004   F061                       BREQ    ??delayloop_0
     27            for (i2=0;i2<1100;i2++) _NOP();
   \                     ??delayloop_1:
   \   00000006   E4EC                       LDI     R30,76
   \   00000008   E0F4                       LDI     R31,4
   \                     ??delayloop_2:
   \   0000000A   0000                       NOP
   \   0000000C   9731                       SBIW    R31 : R30,1
   \   0000000E   2F2E                       MOV     R18,R30
   \   00000010   2B2F                       OR      R18,R31
   \   00000012   F7D9                       BRNE    ??delayloop_2
   \   00000014   5001                       SUBI    R16,1
   \   00000016   4010                       SBCI    R17,0
   \   00000018   2F20                       MOV     R18,R16
   \   0000001A   2B21                       OR      R18,R17
   \   0000001C   F7A1                       BRNE    ??delayloop_1
     28          };
   \                     ??delayloop_0:
   \   0000001E   9508                       RET
     29          //                                                                                                    #pragma inline
     30          //#pragma inline=forced
     31          

   \                                 In segment NEAR_I, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_I>`
     32          const char hs[]="Hey stupid\n\r";
   \                     hs:
   \   00000000                              DS 13
   \   0000000D                              REQUIRE `?<Initializer for hs>`

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
     33          char buf[255];
   \                     buf:
   \   00000000                              DS 255

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
     34          char * cp;
   \                     `cp`:
   \   00000000                              DS 2

   \                                 In segment CODE, align 2, keep-with-next
     35          char getx(char c){
   \                     getx:
     36          switch (c){
   \   00000000   3100                       CPI     R16,16
   \   00000002   F558                       BRCC    ??getx_0
   \   00000004   ....                       LDI     R31,(`?<Jumptable for getx>_0`) >> 16
   \   00000006   BFFB                       OUT     0x3B,R31
   \   00000008   E0F2                       LDI     R31,2
   \   0000000A   9F0F                       MUL     R16,R31
   \   0000000C   01F0                       MOVW    R31 : R30,R1 : R0
   \   0000000E   ....                       SUBI    R30,LOW((-(`?<Jumptable for getx>_0`) & 0xFFFF))
   \   00000010   ....                       SBCI    R31,(-(`?<Jumptable for getx>_0`) & 0xFFFF) >> 8
   \   00000012   9007                       ELPM    R0,Z+
   \   00000014   9016                       ELPM    R1,Z
   \   00000016   01F0                       MOVW    R31 : R30,R1 : R0
   \   00000018   9409                       IJMP
     37          case 0: return '0';
   \                     ??getx_1:
   \   0000001A   E300                       LDI     R16,48
   \   0000001C   9508                       RET
     38          case 1: return '1';
   \                     ??getx_2:
   \   0000001E   E301                       LDI     R16,49
   \   00000020   9508                       RET
     39          case 2: return '2';
   \                     ??getx_3:
   \   00000022   E302                       LDI     R16,50
   \   00000024   9508                       RET
     40          case 3: return '3';
   \                     ??getx_4:
   \   00000026   E303                       LDI     R16,51
   \   00000028   9508                       RET
     41          case 4: return '4';
   \                     ??getx_5:
   \   0000002A   E304                       LDI     R16,52
   \   0000002C   9508                       RET
     42          case 5: return '5';
   \                     ??getx_6:
   \   0000002E   E305                       LDI     R16,53
   \   00000030   9508                       RET
     43          case 6: return '6';
   \                     ??getx_7:
   \   00000032   E306                       LDI     R16,54
   \   00000034   9508                       RET
     44          case 7: return '7';
   \                     ??getx_8:
   \   00000036   E307                       LDI     R16,55
   \   00000038   9508                       RET
     45          case 8: return '8';
   \                     ??getx_9:
   \   0000003A   E308                       LDI     R16,56
   \   0000003C   9508                       RET
     46          case 9: return '9';
   \                     ??getx_10:
   \   0000003E   E309                       LDI     R16,57
   \   00000040   9508                       RET
     47          case 10: return 'A';
   \                     ??getx_11:
   \   00000042   E401                       LDI     R16,65
   \   00000044   9508                       RET
     48          case 11: return 'B';
   \                     ??getx_12:
   \   00000046   E402                       LDI     R16,66
   \   00000048   9508                       RET
     49          case 12: return 'C';
   \                     ??getx_13:
   \   0000004A   E403                       LDI     R16,67
   \   0000004C   9508                       RET
     50          case 13: return 'D';
   \                     ??getx_14:
   \   0000004E   E404                       LDI     R16,68
   \   00000050   9508                       RET
     51          case 14: return 'E';
   \                     ??getx_15:
   \   00000052   E405                       LDI     R16,69
   \   00000054   9508                       RET
     52          case 15: return 'F';
   \                     ??getx_16:
   \   00000056   E406                       LDI     R16,70
   \   00000058   9508                       RET
     53          }
     54          return 0;
   \                     ??getx_0:
   \   0000005A   E000                       LDI     R16,0
   \   0000005C   9508                       RET
     55          };
     56          

   \                                 In segment CODE, align 2, keep-with-next
     57          sendump(char * d, char len){
   \                     sendump:
   \   00000000   927A                       ST      -Y,R7
   \   00000002   926A                       ST      -Y,R6
   \   00000004   925A                       ST      -Y,R5
   \   00000006   924A                       ST      -Y,R4
   \   00000008   93BA                       ST      -Y,R27
   \   0000000A   93AA                       ST      -Y,R26
   \   0000000C   939A                       ST      -Y,R25
   \   0000000E   938A                       ST      -Y,R24
   \   00000010                              REQUIRE ?Register_R4_is_cg_reg
   \   00000010                              REQUIRE ?Register_R5_is_cg_reg
   \   00000010                              REQUIRE ?Register_R6_is_cg_reg
   \   00000010                              REQUIRE ?Register_R7_is_cg_reg
   \   00000010   0128                       MOVW    R5 : R4,R17 : R16
   \   00000012   2F82                       MOV     R24,R18
     58          char i;
     59          buf[0]=0x0d;
   \   00000014   ....                       LDI     R26,LOW(buf)
   \   00000016   ....                       LDI     R27,(buf) >> 8
   \   00000018   E00D                       LDI     R16,13
   \   0000001A   930C                       ST      X,R16
     60          buf[1]=0x0a;
   \   0000001C   E00A                       LDI     R16,10
   \   0000001E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000020   8301                       STD     Z+1,R16
     61          buf[2]='L';
   \   00000022   E40C                       LDI     R16,76
   \   00000024   8302                       STD     Z+2,R16
     62          buf[3]='=';
   \   00000026   E30D                       LDI     R16,61
   \   00000028   8303                       STD     Z+3,R16
     63          buf[4]='0';
   \   0000002A   E300                       LDI     R16,48
   \   0000002C   8304                       STD     Z+4,R16
     64          buf[4]=getx(len>>4);
   \   0000002E   2F02                       MOV     R16,R18
   \   00000030   9502                       SWAP    R16
   \   00000032   700F                       ANDI    R16,0x0F
   \   00000034   ....                       RCALL   getx
   \   00000036   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000038   8304                       STD     Z+4,R16
     65          buf[5]=getx(len&0xf);
   \   0000003A   2F08                       MOV     R16,R24
   \   0000003C   700F                       ANDI    R16,0x0F
   \   0000003E   ....                       RCALL   getx
   \   00000040   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000042   8305                       STD     Z+5,R16
     66          buf[6]=' ';
   \   00000044   E200                       LDI     R16,32
   \   00000046   8306                       STD     Z+6,R16
     67          for(i=0;i<len;i++) {
   \   00000048   2388                       TST     R24
   \   0000004A   F0E1                       BREQ    ??sendump_0
   \   0000004C   013D                       MOVW    R7 : R6,R27 : R26
   \   0000004E   E007                       LDI     R16,7
   \   00000050   0E60                       ADD     R6,R16
   \   00000052   E000                       LDI     R16,0
   \   00000054   1E70                       ADC     R7,R16
   \   00000056   2F98                       MOV     R25,R24
     68            buf[7+i*3]=getx(*d>>4);
   \                     ??sendump_1:
   \   00000058   01F2                       MOVW    R31 : R30,R5 : R4
   \   0000005A   8100                       LD      R16,Z
   \   0000005C   9502                       SWAP    R16
   \   0000005E   700F                       ANDI    R16,0x0F
   \   00000060   ....                       RCALL   getx
   \   00000062   01F3                       MOVW    R31 : R30,R7 : R6
   \   00000064   8300                       ST      Z,R16
     69            buf[8+i*3]=getx(*d&0x0f);
   \   00000066   01F2                       MOVW    R31 : R30,R5 : R4
   \   00000068   9101                       LD      R16,Z+
   \   0000006A   012F                       MOVW    R5 : R4,R31 : R30
   \   0000006C   700F                       ANDI    R16,0x0F
   \   0000006E   ....                       RCALL   getx
   \   00000070   01F3                       MOVW    R31 : R30,R7 : R6
   \   00000072   8301                       STD     Z+1,R16
     70            buf[9+i*3]=',';
   \   00000074   E20C                       LDI     R16,44
   \   00000076   8302                       STD     Z+2,R16
     71            d++;
     72          };
   \   00000078   E003                       LDI     R16,3
   \   0000007A   0E60                       ADD     R6,R16
   \   0000007C   E000                       LDI     R16,0
   \   0000007E   1E70                       ADC     R7,R16
   \   00000080   959A                       DEC     R25
   \   00000082   F751                       BRNE    ??sendump_1
     73          if(u0.state!=1){return;};
   \                     ??sendump_0:
   \   00000084   ....                       LDI     R16,LOW(u0)
   \   00000086   2E40                       MOV     R4,R16
   \   00000088   ....                       LDI     R16,(u0) >> 8
   \   0000008A   2E50                       MOV     R5,R16
   \   0000008C   01F2                       MOVW    R31 : R30,R5 : R4
   \   0000008E   8101                       LDD     R16,Z+1
   \   00000090   3001                       CPI     R16,1
   \   00000092   F469                       BRNE    ??sendump_2
     74          sen0((char *)&buf,len*3+7);
   \   00000094   E003                       LDI     R16,3
   \   00000096   9F80                       MUL     R24,R16
   \   00000098   2D20                       MOV     R18,R0
   \   0000009A   5F29                       SUBI    R18,249
   \   0000009C   018D                       MOVW    R17 : R16,R27 : R26
   \   0000009E   ........                   CALL    sen0
   \   000000A2   C001                       RJMP    ??sendump_3
     75          while(u0.state!=1){_NOP();};
   \                     ??sendump_4:
   \   000000A4   0000                       NOP
   \                     ??sendump_3:
   \   000000A6   01F2                       MOVW    R31 : R30,R5 : R4
   \   000000A8   8101                       LDD     R16,Z+1
   \   000000AA   3001                       CPI     R16,1
   \   000000AC   F7D9                       BRNE    ??sendump_4
   \                     ??sendump_2:
   \   000000AE   9189                       LD      R24,Y+
   \   000000B0   9199                       LD      R25,Y+
   \   000000B2   91A9                       LD      R26,Y+
   \   000000B4   91B9                       LD      R27,Y+
   \   000000B6   9049                       LD      R4,Y+
   \   000000B8   9059                       LD      R5,Y+
   \   000000BA   9069                       LD      R6,Y+
   \   000000BC   9079                       LD      R7,Y+
   \   000000BE   9508                       RET
     76          
     77          };

   \                                 In segment CODE, align 2, keep-with-next
     78          sentst(){
   \                     sentst:
   \   00000000   93BA                       ST      -Y,R27
   \   00000002   93AA                       ST      -Y,R26
     79          buf[0]=0;
   \   00000004   ....                       LDI     R16,LOW(buf)
   \   00000006   ....                       LDI     R17,(buf) >> 8
   \   00000008   E020                       LDI     R18,0
   \   0000000A   01F8                       MOVW    R31 : R30,R17 : R16
   \   0000000C   8320                       ST      Z,R18
     80          buf[1]=0x55;
   \   0000000E   E525                       LDI     R18,85
   \   00000010   8321                       STD     Z+1,R18
     81          buf[2]=0xaa;
   \   00000012   EA2A                       LDI     R18,170
   \   00000014   8322                       STD     Z+2,R18
     82          buf[3]=0xab;
   \   00000016   EA2B                       LDI     R18,171
   \   00000018   8323                       STD     Z+3,R18
     83          buf[4]=0xac;
   \   0000001A   EA2C                       LDI     R18,172
   \   0000001C   8324                       STD     Z+4,R18
     84          
     85          if(u0.state!=1){return;};
   \   0000001E   ....                       LDI     R26,LOW(u0)
   \   00000020   ....                       LDI     R27,(u0) >> 8
   \   00000022   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000024   8121                       LDD     R18,Z+1
   \   00000026   3021                       CPI     R18,1
   \   00000028   F451                       BRNE    ??sentst_0
     86          sen0((char *)&buf,4);
   \   0000002A   E024                       LDI     R18,4
   \   0000002C   ........                   CALL    sen0
   \   00000030   C001                       RJMP    ??sentst_1
     87          while(u0.state!=1){_NOP();};
   \                     ??sentst_2:
   \   00000032   0000                       NOP
   \                     ??sentst_1:
   \   00000034   9611                       ADIW    R27 : R26,1
   \   00000036   910C                       LD      R16,X
   \   00000038   9711                       SBIW    R27 : R26,1
   \   0000003A   3001                       CPI     R16,1
   \   0000003C   F7D1                       BRNE    ??sentst_2
   \                     ??sentst_0:
   \   0000003E   91A9                       LD      R26,Y+
   \   00000040   91B9                       LD      R27,Y+
   \   00000042   9508                       RET
     88          
     89          };
     90          //extern void inibase();
     91          //extern UINT * hrem[0x400];  
     92          ///////////////////////////////////////////////////////////////////////////
     93          // Инициируем порты ввода вывода для чтения перемычек и зажигания лампочек

   \                                 In segment CODE, align 2, keep-with-next
     94          void iniports(){
   \                     iniports:
     95          //  DDRB=0XFF;
     96          //  DDRA=0XFF;
     97            
     98            DDRC = 0xff; //Лампочки на вывод
   \   00000000   EF0F                       LDI     R16,255
   \   00000002   BB04                       OUT     0x14,R16
     99            DDRG = 0x03;
   \   00000004   E003                       LDI     R16,3
   \   00000006   93000064                   STS     100,R16
    100            PORTC = 0x00;
   \   0000000A   E000                       LDI     R16,0
   \   0000000C   BB05                       OUT     0x15,R16
    101            PORTG = 0x00;
   \   0000000E   93000065                   STS     101,R16
    102            redonw
   \   00000012   E002                       LDI     R16,2
   \   00000014   93000065                   STS     101,R16
    103          
    104            PORTG_Bit3=1; //Включить PULUP на перемычки
   \   00000018   E00A                       LDI     R16,10
   \   0000001A   93000065                   STS     101,R16
    105            PORTG_Bit4=1;
   \   0000001E   E10A                       LDI     R16,26
   \   00000020   93000065                   STS     101,R16
    106            PORTD_Bit6=1;
   \   00000024   9A96                       SBI     0x12,0x06
    107            PORTD_Bit7=1;
   \   00000026   9A97                       SBI     0x12,0x07
    108            
    109          }
   \   00000028   9508                       RET
    110          /*******************************************************************************
    111           процесс индикации
    112          *******************************************************************************/ 
    113          #define nt 1000

   \                                 In segment NEAR_Z, align 1, keep-with-next
   \   00000000                              REQUIRE `?<Segment init: NEAR_Z>`
    114          char ledstate;
   \                     ledstate:
   \   00000000                              DS 1
    115          extern char lineflags; // бит 0-3 подключен датчик 4-7 - более одного нового датчика

   \                                 In segment CODE, align 2, keep-with-next
    116          void ledpr(){
   \                     ledpr:
   \   00000000   93BA                       ST      -Y,R27
   \   00000002   93AA                       ST      -Y,R26
    117              if ((ramb[0x18]&0x7f00)!=0) {//поломка сигнализатора
   \   00000004   ....                       LDI     R26,LOW(ramb)
   \   00000006   ....                       LDI     R27,(ramb) >> 8
   \   00000008   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000000A   A911                       LDD     R17,Z+49
   \   0000000C   771F                       ANDI    R17,0x7F
   \   0000000E   F0A9                       BREQ    ??ledpr_0
    118                      if ((time&1024)==0){grw=1;redw=0; }
   \   00000010   ....                       LDI     R30,LOW(time)
   \   00000012   ....                       LDI     R31,(time) >> 8
   \   00000014   8101                       LDD     R16,Z+1
   \   00000016   FD02                       SBRC    R16,2
   \   00000018   C009                       RJMP    ??ledpr_1
   \   0000001A   91000065                   LDS     R16,101
   \   0000001E   6001                       ORI     R16,0x01
   \   00000020   93000065                   STS     101,R16
   \   00000024   7F0D                       ANDI    R16,0xFD
   \                     ??ledpr_2:
   \   00000026   93000065                   STS     101,R16
   \   0000002A   C189                       RJMP    ??ledpr_3
    119                      else {grw=0;redw=1;}
   \                     ??ledpr_1:
   \   0000002C   91000065                   LDS     R16,101
   \   00000030   7F0E                       ANDI    R16,0xFE
   \   00000032   93000065                   STS     101,R16
   \   00000036   6002                       ORI     R16,0x02
   \   00000038   CFF6                       RJMP    ??ledpr_2
    120                      return;
    121              }
    122          
    123             if ((ramb[0x18]&0x8000)!=0){ //режим конфигурирования микролан)
   \                     ??ledpr_0:
   \   0000003A   A901                       LDD     R16,Z+49
   \   0000003C   FF07                       SBRS    R16,7
   \   0000003E   C0B6                       RJMP    ??ledpr_4
    124                if (ledstate!= 2){ //только что перешли в режим конфигурирования микролан
   \   00000040   9100....                   LDS     R16,ledstate
   \   00000044   3002                       CPI     R16,2
   \   00000046   F0E9                       BREQ    ??ledpr_5
    125                   offw; off1;  off2; off3; off4; 
   \   00000048   91000065                   LDS     R16,101
   \   0000004C   7F0E                       ANDI    R16,0xFE
   \   0000004E   93000065                   STS     101,R16
   \   00000052   7F0D                       ANDI    R16,0xFD
   \   00000054   93000065                   STS     101,R16
   \   00000058   B305                       IN      R16,0x15
   \   0000005A   730F                       ANDI    R16,0x3F
   \   0000005C   BB05                       OUT     0x15,R16
   \   0000005E   B305                       IN      R16,0x15
   \   00000060   7C0F                       ANDI    R16,0xCF
   \   00000062   BB05                       OUT     0x15,R16
   \   00000064   B305                       IN      R16,0x15
   \   00000066   7F03                       ANDI    R16,0xF3
   \   00000068   BB05                       OUT     0x15,R16
   \   0000006A   B305                       IN      R16,0x15
   \   0000006C   7F0C                       ANDI    R16,0xFC
   \   0000006E   BB05                       OUT     0x15,R16
    126                   ledstate=2;
   \   00000070   E002                       LDI     R16,2
   \                     ??ledpr_6:
   \   00000072   9300....                   STS     ledstate,R16
    127                   settout(0,nt);
   \   00000076   EE28                       LDI     R18,232
   \   00000078   E033                       LDI     R19,3
   \   0000007A   E000                       LDI     R16,0
   \   0000007C   ........                   CALL    settout
    128                   return;
   \   00000080   C15E                       RJMP    ??ledpr_3
    129                }else if (gettout(0)==0) {
   \                     ??ledpr_5:
   \   00000082   E000                       LDI     R16,0
   \   00000084   ........                   CALL    gettout
   \   00000088   2300                       TST     R16
   \   0000008A   F009                       BREQ    $+2+2
   \   0000008C   C158                       RJMP    ??ledpr_3
    130                          if (lineflags==0) {
   \   0000008E   9100....                   LDS     R16,lineflags
   \   00000092   2300                       TST     R16
   \   00000094   EE28                       LDI     R18,232
   \   00000096   E033                       LDI     R19,3
   \   00000098   E000                       LDI     R16,0
   \   0000009A   F4C9                       BRNE    ??ledpr_7
    131                             { settout(0,nt);grw^=1;gr1^=1;gr2^=1;gr3^=1;gr4 ^=1; return;}
   \   0000009C   ........                   CALL    settout
   \   000000A0   E001                       LDI     R16,1
   \   000000A2   91100065                   LDS     R17,101
   \   000000A6   2710                       EOR     R17,R16
   \   000000A8   93100065                   STS     101,R17
   \   000000AC   E400                       LDI     R16,64
   \   000000AE   B315                       IN      R17,0x15
   \   000000B0   2710                       EOR     R17,R16
   \   000000B2   BB15                       OUT     0x15,R17
   \   000000B4   E100                       LDI     R16,16
   \   000000B6   B315                       IN      R17,0x15
   \   000000B8   2710                       EOR     R17,R16
   \   000000BA   BB15                       OUT     0x15,R17
   \   000000BC   E004                       LDI     R16,4
   \   000000BE   B315                       IN      R17,0x15
   \   000000C0   2710                       EOR     R17,R16
   \   000000C2   BB15                       OUT     0x15,R17
   \   000000C4   E001                       LDI     R16,1
   \   000000C6   B315                       IN      R17,0x15
   \   000000C8   2710                       EOR     R17,R16
   \   000000CA   BB15                       OUT     0x15,R17
   \   000000CC   C138                       RJMP    ??ledpr_3
    132                          }else {  settout(0,nt);
   \                     ??ledpr_7:
   \   000000CE   ........                   CALL    settout
    133                                  if ((lineflags&0xf0)!=0)  {  grw=0; redw=1;}
   \   000000D2   9100....                   LDS     R16,lineflags
   \   000000D6   7F00                       ANDI    R16,0xF0
   \   000000D8   F039                       BREQ    ??ledpr_8
   \   000000DA   91000065                   LDS     R16,101
   \   000000DE   7F0E                       ANDI    R16,0xFE
   \   000000E0   93000065                   STS     101,R16
   \   000000E4   6002                       ORI     R16,0x02
   \   000000E6   C009                       RJMP    ??ledpr_9
    134                                  else {grw^=1;redw=0;} 
   \                     ??ledpr_8:
   \   000000E8   E001                       LDI     R16,1
   \   000000EA   91100065                   LDS     R17,101
   \   000000EE   2710                       EOR     R17,R16
   \   000000F0   93100065                   STS     101,R17
   \   000000F4   91000065                   LDS     R16,101
   \   000000F8   7F0D                       ANDI    R16,0xFD
   \                     ??ledpr_9:
   \   000000FA   93000065                   STS     101,R16
    135                                      //проверяем флаги по каждой линии  на ошибочное подключение
    136                                    if ((lineflags&0x10)!=0) {gr1=0;red1^=1;}  
   \   000000FE   ....                       LDI     R30,LOW(lineflags)
   \   00000100   ....                       LDI     R31,(lineflags) >> 8
   \   00000102   8100                       LD      R16,Z
   \   00000104   FF04                       SBRS    R16,4
   \   00000106   C005                       RJMP    ??ledpr_10
   \   00000108   98AE                       CBI     0x15,0x06
   \   0000010A   E800                       LDI     R16,128
   \   0000010C   B315                       IN      R17,0x15
   \   0000010E   2710                       EOR     R17,R16
   \   00000110   BB15                       OUT     0x15,R17
    137                                    if ((lineflags&0x20)!=0) {gr2=0;red2^=1;}
   \                     ??ledpr_10:
   \   00000112   8100                       LD      R16,Z
   \   00000114   FF05                       SBRS    R16,5
   \   00000116   C005                       RJMP    ??ledpr_11
   \   00000118   98AC                       CBI     0x15,0x04
   \   0000011A   E200                       LDI     R16,32
   \   0000011C   B315                       IN      R17,0x15
   \   0000011E   2710                       EOR     R17,R16
   \   00000120   BB15                       OUT     0x15,R17
    138                                    if ((lineflags&0x40)!=0) {gr3=0;red3^=1;}                          
   \                     ??ledpr_11:
   \   00000122   8100                       LD      R16,Z
   \   00000124   FF06                       SBRS    R16,6
   \   00000126   C005                       RJMP    ??ledpr_12
   \   00000128   98AA                       CBI     0x15,0x02
   \   0000012A   E008                       LDI     R16,8
   \   0000012C   B315                       IN      R17,0x15
   \   0000012E   2710                       EOR     R17,R16
   \   00000130   BB15                       OUT     0x15,R17
    139                                    if ((lineflags&0x80)!=0) {gr4=0;red4^=1;}
   \                     ??ledpr_12:
   \   00000132   8100                       LD      R16,Z
   \   00000134   FF07                       SBRS    R16,7
   \   00000136   C005                       RJMP    ??ledpr_13
   \   00000138   98A8                       CBI     0x15,0x00
   \   0000013A   E002                       LDI     R16,2
   \   0000013C   B315                       IN      R17,0x15
   \   0000013E   2710                       EOR     R17,R16
   \   00000140   BB15                       OUT     0x15,R17
    140                                      //проверяем флаги на каждой линии на появление нового датчика  
    141                                    if ((lineflags&1)!=0) {gr1=0;red1^=1;if (red1==0)lineflags&=~1;}  
   \                     ??ledpr_13:
   \   00000142   8100                       LD      R16,Z
   \   00000144   FF00                       SBRS    R16,0
   \   00000146   C00A                       RJMP    ??ledpr_14
   \   00000148   98AE                       CBI     0x15,0x06
   \   0000014A   E800                       LDI     R16,128
   \   0000014C   B315                       IN      R17,0x15
   \   0000014E   2710                       EOR     R17,R16
   \   00000150   BB15                       OUT     0x15,R17
   \   00000152   99AF                       SBIC    0x15,0x07
   \   00000154   C003                       RJMP    ??ledpr_14
   \   00000156   8100                       LD      R16,Z
   \   00000158   7F0E                       ANDI    R16,0xFE
   \   0000015A   8300                       ST      Z,R16
    142                                    if ((lineflags&2)!=0) {gr2=0;red2^=1;if (red2==0)lineflags&=~2;}
   \                     ??ledpr_14:
   \   0000015C   8100                       LD      R16,Z
   \   0000015E   FF01                       SBRS    R16,1
   \   00000160   C00A                       RJMP    ??ledpr_15
   \   00000162   98AC                       CBI     0x15,0x04
   \   00000164   E200                       LDI     R16,32
   \   00000166   B315                       IN      R17,0x15
   \   00000168   2710                       EOR     R17,R16
   \   0000016A   BB15                       OUT     0x15,R17
   \   0000016C   99AD                       SBIC    0x15,0x05
   \   0000016E   C003                       RJMP    ??ledpr_15
   \   00000170   8100                       LD      R16,Z
   \   00000172   7F0D                       ANDI    R16,0xFD
   \   00000174   8300                       ST      Z,R16
    143                                    if ((lineflags&4)!=0) {gr3=0;red3^=1;if (red3==0)lineflags&=~4;}                          
   \                     ??ledpr_15:
   \   00000176   8100                       LD      R16,Z
   \   00000178   FF02                       SBRS    R16,2
   \   0000017A   C00A                       RJMP    ??ledpr_16
   \   0000017C   98AA                       CBI     0x15,0x02
   \   0000017E   E008                       LDI     R16,8
   \   00000180   B315                       IN      R17,0x15
   \   00000182   2710                       EOR     R17,R16
   \   00000184   BB15                       OUT     0x15,R17
   \   00000186   99AB                       SBIC    0x15,0x03
   \   00000188   C003                       RJMP    ??ledpr_16
   \   0000018A   8100                       LD      R16,Z
   \   0000018C   7F0B                       ANDI    R16,0xFB
   \   0000018E   8300                       ST      Z,R16
    144                                    if ((lineflags&8)!=0) {gr4=0;red4^=1;if (red4==0)lineflags&=~8;}
   \                     ??ledpr_16:
   \   00000190   8100                       LD      R16,Z
   \   00000192   FF03                       SBRS    R16,3
   \   00000194   C0D4                       RJMP    ??ledpr_3
   \   00000196   98A8                       CBI     0x15,0x00
   \   00000198   E002                       LDI     R16,2
   \   0000019A   B315                       IN      R17,0x15
   \   0000019C   2710                       EOR     R17,R16
   \   0000019E   BB15                       OUT     0x15,R17
   \   000001A0   99A9                       SBIC    0x15,0x01
   \   000001A2   C0CD                       RJMP    ??ledpr_3
   \   000001A4   8100                       LD      R16,Z
   \   000001A6   7F07                       ANDI    R16,0xF7
   \   000001A8   8300                       ST      Z,R16
   \   000001AA   C0C9                       RJMP    ??ledpr_3
    145                                  return;  
    146                          };
    147                };
    148                }
    149            else{ // индикация в режиме Работа
    150          /*      if (ledstate!= 3){ //только что перешли в режим работа
    151                   offw; off1;  off2; off3; off4; 
    152                   ledstate=3;
    153                   settout(0,nt);
    154                   return;
    155                }else {
    156                     if (gettout(0)!=0) {return;}
    157                     else {
    158                        settout(0,nt);
    159                        grw^=1; gron1;gron2;gron3;gron4;
    160                     }
    161                }        */
    162                if ((ledstate&0x0f)!= 3){ //только что перешли в режим работа
   \                     ??ledpr_4:
   \   000001AC   9100....                   LDS     R16,ledstate
   \   000001B0   700F                       ANDI    R16,0x0F
   \   000001B2   3003                       CPI     R16,3
   \   000001B4   F0B1                       BREQ    ??ledpr_17
    163                   off1;  off2; off3; off4; 
   \   000001B6   B305                       IN      R16,0x15
   \   000001B8   730F                       ANDI    R16,0x3F
   \   000001BA   BB05                       OUT     0x15,R16
   \   000001BC   B305                       IN      R16,0x15
   \   000001BE   7C0F                       ANDI    R16,0xCF
   \   000001C0   BB05                       OUT     0x15,R16
   \   000001C2   B305                       IN      R16,0x15
   \   000001C4   7F03                       ANDI    R16,0xF3
   \   000001C6   BB05                       OUT     0x15,R16
   \   000001C8   B305                       IN      R16,0x15
   \   000001CA   7F0C                       ANDI    R16,0xFC
   \   000001CC   BB05                       OUT     0x15,R16
    164                   redw=0;
   \   000001CE   91000065                   LDS     R16,101
   \   000001D2   7F0D                       ANDI    R16,0xFD
   \   000001D4   93000065                   STS     101,R16
    165                   grw=1; //зажгли зеленую;
   \   000001D8   6001                       ORI     R16,0x01
   \   000001DA   93000065                   STS     101,R16
    166                   ledstate=3;
   \   000001DE   E003                       LDI     R16,3
   \   000001E0   CF48                       RJMP    ??ledpr_6
    167                   settout(0,nt);
    168                   return;
    169                }else {
    170                   if ((SEND0!=0)||SEND1!=0){ //идет передача по модбасу
   \                     ??ledpr_17:
   \   000001E2   9110....                   LDS     R17,ledstate
   \   000001E6   7F10                       ANDI    R17,0xF0
   \   000001E8   99D8                       SBIC    0x1B,0x00
   \   000001EA   C002                       RJMP    ??ledpr_18
   \   000001EC   9BC6                       SBIS    0x18,0x06
   \   000001EE   C02B                       RJMP    ??ledpr_19
    171                       redw=0; 
   \                     ??ledpr_18:
   \   000001F0   91000065                   LDS     R16,101
   \   000001F4   7F0D                       ANDI    R16,0xFD
   \   000001F6   93000065                   STS     101,R16
    172                       if ((ledstate&0xf0)==0){//до этого передачи не было
   \   000001FA   2311                       TST     R17
   \   000001FC   F461                       BRNE    ??ledpr_20
    173                           grw=0;settout(0,nt);
   \   000001FE   7F0E                       ANDI    R16,0xFE
   \   00000200   93000065                   STS     101,R16
   \   00000204   EE28                       LDI     R18,232
   \   00000206   E033                       LDI     R19,3
   \   00000208   E000                       LDI     R16,0
   \   0000020A   ........                   CALL    settout
    174                           ledstate=0x83;
   \   0000020E   E803                       LDI     R16,131
   \                     ??ledpr_21:
   \   00000210   9300....                   STS     ledstate,R16
   \   00000214   C02C                       RJMP    ??ledpr_22
    175                       } else { //до этого уже был режим передачи 
    176                           if(gettout(0)!=0) goto lineled;
   \                     ??ledpr_20:
   \   00000216   E000                       LDI     R16,0
   \   00000218   ........                   CALL    gettout
   \   0000021C   2300                       TST     R16
   \   0000021E   F539                       BRNE    ??ledpr_22
    177                           if (grw==0){// зеленая не горела слишком долго
   \   00000220   91000065                   LDS     R16,101
   \   00000224   FD00                       SBRC    R16,0
   \   00000226   C009                       RJMP    ??ledpr_23
    178                            grw=1;settout(0,200);//зажгли зеленую на 200мс
   \   00000228   6001                       ORI     R16,0x01
   \   0000022A   93000065                   STS     101,R16
   \   0000022E   EC28                       LDI     R18,200
   \   00000230   E030                       LDI     R19,0
   \                     ??ledpr_24:
   \   00000232   E000                       LDI     R16,0
   \   00000234   ........                   CALL    settout
    179                            goto lineled;
   \   00000238   C01A                       RJMP    ??ledpr_22
    180                           }else { //тушим зеленую и взводим таймаут
    181                            grw=0; settout(0,nt);
   \                     ??ledpr_23:
   \   0000023A   7F0E                       ANDI    R16,0xFE
   \   0000023C   93000065                   STS     101,R16
   \   00000240   EE28                       LDI     R18,232
   \   00000242   E033                       LDI     R19,3
   \   00000244   CFF6                       RJMP    ??ledpr_24
    182                            goto lineled;
    183                           } 
    184                       }  
    185                   }else if ((ledstate&0xf0)==0){ //до этого передачи не было
   \                     ??ledpr_19:
   \   00000246   F071                       BREQ    ??ledpr_25
    186                             grw=1; goto lineled;
    187                         } else if (grw!=0){ //была передача но горел зеленый, значит до этого он слишком долго 
   \   00000248   91100065                   LDS     R17,101
   \   0000024C   FF10                       SBRS    R17,0
   \   0000024E   C007                       RJMP    ??ledpr_26
    188                                             //не горел. Остаемся в том же состоянии пока не истечет таймаут на зеленый
    189                                   if (gettout(0)!=0) {goto lineled;}
   \   00000250   E000                       LDI     R16,0
   \   00000252   ........                   CALL    gettout
   \   00000256   2300                       TST     R16
   \   00000258   F451                       BRNE    ??ledpr_22
    190                                   else ledstate=3; // сбросили флаг отработки автомата индикации приема   
   \   0000025A   E003                       LDI     R16,3
   \   0000025C   CFD9                       RJMP    ??ledpr_21
    191                                }else { //зеленый не горел - просто зажжем его и сбросим автомат
    192                                    ledstate=3; grw=1;
   \                     ??ledpr_26:
   \   0000025E   E003                       LDI     R16,3
   \   00000260   9300....                   STS     ledstate,R16
   \                     ??ledpr_25:
   \   00000264   91000065                   LDS     R16,101
   \   00000268   6001                       ORI     R16,0x01
   \   0000026A   93000065                   STS     101,R16
    193                                    goto lineled;
    194                                }                   
    195                   
    196          lineled:  // обработка индикации шлейфа
    197            
    198                    if ((ramb[0x018]&1)!=0) { //неисправность шлейфа 1
   \                     ??ledpr_22:
   \   0000026E   01FD                       MOVW    R31 : R30,R27 : R26
   \   00000270   A900                       LDD     R16,Z+48
   \   00000272   FF00                       SBRS    R16,0
   \   00000274   C008                       RJMP    ??ledpr_27
    199                        if ((time&1024)==0){gr1=1;red1=0;}
   \   00000276   ....                       LDI     R30,LOW(time)
   \   00000278   ....                       LDI     R31,(time) >> 8
   \   0000027A   8101                       LDD     R16,Z+1
   \   0000027C   FF02                       SBRS    R16,2
   \   0000027E   C00F                       RJMP    ??ledpr_28
    200                      else {gr1=0;red1=1;}
   \                     ??ledpr_29:
   \   00000280   98AE                       CBI     0x15,0x06
   \   00000282   9AAF                       SBI     0x15,0x07
   \   00000284   C00E                       RJMP    ??ledpr_30
    201                    }else if((hrem[0x160]!=0)||(hrem[0x161]!=0)) {gr1=0;red1=1;}//тревога шлейфа 
   \                     ??ledpr_27:
   \   00000286   ....                       LDI     R30,LOW((hrem + 704))
   \   00000288   ....                       LDI     R31,(hrem + 704) >> 8
   \   0000028A   8100                       LD      R16,Z
   \   0000028C   8111                       LDD     R17,Z+1
   \   0000028E   2B01                       OR      R16,R17
   \   00000290   F7B9                       BRNE    ??ledpr_29
   \   00000292   ....                       LDI     R30,LOW((hrem + 706))
   \   00000294   ....                       LDI     R31,(hrem + 706) >> 8
   \   00000296   8100                       LD      R16,Z
   \   00000298   8111                       LDD     R17,Z+1
   \   0000029A   2B01                       OR      R16,R17
   \   0000029C   F789                       BRNE    ??ledpr_29
    202                          else {gr1=1;red1=0;}; //шлейф в норме
   \                     ??ledpr_28:
   \   0000029E   9AAE                       SBI     0x15,0x06
   \   000002A0   98AF                       CBI     0x15,0x07
    203                          
    204                    }
    205                    if ((ramb[0x018]&2)!=0) { //неисправность шлейфа 2
   \                     ??ledpr_30:
   \   000002A2   01FD                       MOVW    R31 : R30,R27 : R26
   \   000002A4   A900                       LDD     R16,Z+48
   \   000002A6   FF01                       SBRS    R16,1
   \   000002A8   C008                       RJMP    ??ledpr_31
    206                        if ((time&1024)==0){gr2=1;red2=0;}
   \   000002AA   ....                       LDI     R30,LOW(time)
   \   000002AC   ....                       LDI     R31,(time) >> 8
   \   000002AE   8101                       LDD     R16,Z+1
   \   000002B0   FF02                       SBRS    R16,2
   \   000002B2   C00F                       RJMP    ??ledpr_32
    207                      else {gr2=0;red2=1;}
   \                     ??ledpr_33:
   \   000002B4   98AC                       CBI     0x15,0x04
   \   000002B6   9AAD                       SBI     0x15,0x05
   \   000002B8   C00E                       RJMP    ??ledpr_34
    208                    }else if((hrem[0x162]!=0)||(hrem[0x163]!=0)) {gr2=0;red2=1;}//тревога шлейфа 
   \                     ??ledpr_31:
   \   000002BA   ....                       LDI     R30,LOW((hrem + 708))
   \   000002BC   ....                       LDI     R31,(hrem + 708) >> 8
   \   000002BE   8100                       LD      R16,Z
   \   000002C0   8111                       LDD     R17,Z+1
   \   000002C2   2B01                       OR      R16,R17
   \   000002C4   F7B9                       BRNE    ??ledpr_33
   \   000002C6   ....                       LDI     R30,LOW((hrem + 710))
   \   000002C8   ....                       LDI     R31,(hrem + 710) >> 8
   \   000002CA   8100                       LD      R16,Z
   \   000002CC   8111                       LDD     R17,Z+1
   \   000002CE   2B01                       OR      R16,R17
   \   000002D0   F789                       BRNE    ??ledpr_33
    209                          else {gr2=1;red2=0;}; //шлейф в норме
   \                     ??ledpr_32:
   \   000002D2   9AAC                       SBI     0x15,0x04
   \   000002D4   98AD                       CBI     0x15,0x05
    210                     
    211                    if ((ramb[0x018]&4)!=0) { //неисправность шлейфа 3
   \                     ??ledpr_34:
   \   000002D6   01FD                       MOVW    R31 : R30,R27 : R26
   \   000002D8   A900                       LDD     R16,Z+48
   \   000002DA   FF02                       SBRS    R16,2
   \   000002DC   C008                       RJMP    ??ledpr_35
    212                        if ((time&1024)==0){gr3=1;red3=0;}
   \   000002DE   ....                       LDI     R30,LOW(time)
   \   000002E0   ....                       LDI     R31,(time) >> 8
   \   000002E2   8101                       LDD     R16,Z+1
   \   000002E4   FF02                       SBRS    R16,2
   \   000002E6   C00F                       RJMP    ??ledpr_36
    213                      else {gr3=0;red3=1;}
   \                     ??ledpr_37:
   \   000002E8   98AA                       CBI     0x15,0x02
   \   000002EA   9AAB                       SBI     0x15,0x03
   \   000002EC   C00E                       RJMP    ??ledpr_38
    214                    }else if((hrem[0x164]!=0)||(hrem[0x165]!=0)) {gr3=0;red3=1;}//тревога шлейфа 
   \                     ??ledpr_35:
   \   000002EE   ....                       LDI     R30,LOW((hrem + 712))
   \   000002F0   ....                       LDI     R31,(hrem + 712) >> 8
   \   000002F2   8100                       LD      R16,Z
   \   000002F4   8111                       LDD     R17,Z+1
   \   000002F6   2B01                       OR      R16,R17
   \   000002F8   F7B9                       BRNE    ??ledpr_37
   \   000002FA   ....                       LDI     R30,LOW((hrem + 714))
   \   000002FC   ....                       LDI     R31,(hrem + 714) >> 8
   \   000002FE   8100                       LD      R16,Z
   \   00000300   8111                       LDD     R17,Z+1
   \   00000302   2B01                       OR      R16,R17
   \   00000304   F789                       BRNE    ??ledpr_37
    215                          else {gr3=1;red3=0;}; //шлейф в норме
   \                     ??ledpr_36:
   \   00000306   9AAA                       SBI     0x15,0x02
   \   00000308   98AB                       CBI     0x15,0x03
    216                     
    217                    if ((ramb[0x018]&8)!=0) { //неисправность шлейфа 4
   \                     ??ledpr_38:
   \   0000030A   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000030C   A900                       LDD     R16,Z+48
   \   0000030E   FF03                       SBRS    R16,3
   \   00000310   C008                       RJMP    ??ledpr_39
    218                        if ((time&1024)==0){gr4=1;red4=0;}
   \   00000312   ....                       LDI     R30,LOW(time)
   \   00000314   ....                       LDI     R31,(time) >> 8
   \   00000316   8101                       LDD     R16,Z+1
   \   00000318   FF02                       SBRS    R16,2
   \   0000031A   C00F                       RJMP    ??ledpr_40
    219                      else {gr4=0;red4=1;}
   \                     ??ledpr_41:
   \   0000031C   98A8                       CBI     0x15,0x00
   \   0000031E   9AA9                       SBI     0x15,0x01
   \   00000320   C00E                       RJMP    ??ledpr_3
    220                    }else if((hrem[0x166]!=0)||(hrem[0x167]!=0)) {gr4=0;red4=1;}//тревога шлейфа 
   \                     ??ledpr_39:
   \   00000322   ....                       LDI     R30,LOW((hrem + 716))
   \   00000324   ....                       LDI     R31,(hrem + 716) >> 8
   \   00000326   8100                       LD      R16,Z
   \   00000328   8111                       LDD     R17,Z+1
   \   0000032A   2B01                       OR      R16,R17
   \   0000032C   F7B9                       BRNE    ??ledpr_41
   \   0000032E   ....                       LDI     R30,LOW((hrem + 718))
   \   00000330   ....                       LDI     R31,(hrem + 718) >> 8
   \   00000332   8100                       LD      R16,Z
   \   00000334   8111                       LDD     R17,Z+1
   \   00000336   2B01                       OR      R16,R17
   \   00000338   F789                       BRNE    ??ledpr_41
    221                          else {gr4=1;red4=0;}; //шлейф в норме
   \                     ??ledpr_40:
   \   0000033A   9AA8                       SBI     0x15,0x00
   \   0000033C   98A9                       CBI     0x15,0x01
   \                     ??ledpr_3:
   \   0000033E   91A9                       LD      R26,Y+
   \   00000340   91B9                       LD      R27,Y+
   \   00000342   9508                       RET
    222                     
    223           }  
    224          }

   \                                 In segment CODE, align 2, keep-with-next
    225          void resalarm(){
   \                     resalarm:
   \   00000000   93BA                       ST      -Y,R27
   \   00000002   93AA                       ST      -Y,R26
    226          UINT adr,tmp;
    227          if (ramb[0x0f]==0)return;
   \   00000004   ....                       LDI     R26,LOW(ramb)
   \   00000006   ....                       LDI     R27,(ramb) >> 8
   \   00000008   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000000A   8D06                       LDD     R16,Z+30
   \   0000000C   8D17                       LDD     R17,Z+31
   \   0000000E   2B01                       OR      R16,R17
   \   00000010   F1B9                       BREQ    ??resalarm_0
    228          adr=((ramb[0x0f]&0xcf00)<<1)+((ramb[0x0f]&0x1f)>>4)+0x160;
   \   00000012   E000                       LDI     R16,0
   \   00000014   7C1F                       ANDI    R17,0xCF
   \   00000016   0F00                       LSL     R16
   \   00000018   1F11                       ROL     R17
   \   0000001A   8D66                       LDD     R22,Z+30
   \   0000001C   FB64                       BST     R22,4
   \   0000001E   E060                       LDI     R22,0
   \   00000020   E070                       LDI     R23,0
   \   00000022   F960                       BLD     R22,0
   \   00000024   0F60                       ADD     R22,R16
   \   00000026   1F71                       ADC     R23,R17
   \   00000028   5A60                       SUBI    R22,160
   \   0000002A   4F7E                       SBCI    R23,254
    229          tmp=hrem[adr]&~(1<<(ramb[0x0f]&0x0f)-1);
    230          
    231          ramb[0]=ramb[0x0f];
   \   0000002C   8D06                       LDD     R16,Z+30
   \   0000002E   8D17                       LDD     R17,Z+31
   \   00000030   930D                       ST      X+,R16
   \   00000032   931C                       ST      X,R17
   \   00000034   9711                       SBIW    R27 : R26,1
    232          ramb[1]=adr;
   \   00000036   8362                       STD     Z+2,R22
   \   00000038   8373                       STD     Z+3,R23
    233          ramb[2]=hrem[adr];
   \   0000003A   018B                       MOVW    R17 : R16,R23 : R22
   \   0000003C   0F00                       LSL     R16
   \   0000003E   1F11                       ROL     R17
   \   00000040   01F8                       MOVW    R31 : R30,R17 : R16
   \   00000042   ....                       SUBI    R30,LOW((-(hrem) & 0xFFFF))
   \   00000044   ....                       SBCI    R31,(-(hrem) & 0xFFFF) >> 8
   \   00000046   8120                       LD      R18,Z
   \   00000048   8131                       LDD     R19,Z+1
   \   0000004A   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000004C   8324                       STD     Z+4,R18
   \   0000004E   8335                       STD     Z+5,R19
    234          ramb[3]=tmp;
   \   00000050   E001                       LDI     R16,1
   \   00000052   E010                       LDI     R17,0
   \   00000054   8D46                       LDD     R20,Z+30
   \   00000056   704F                       ANDI    R20,0x0F
   \   00000058   954A                       DEC     R20
   \   0000005A   ........                   CALL    ?S_SHL_L02
   \   0000005E   9500                       COM     R16
   \   00000060   9510                       COM     R17
   \   00000062   01A8                       MOVW    R21 : R20,R17 : R16
   \   00000064   2342                       AND     R20,R18
   \   00000066   2353                       AND     R21,R19
   \   00000068   8346                       STD     Z+6,R20
   \   0000006A   8357                       STD     Z+7,R21
    235          ramb[4]=~(1<<(ramb[0x0f]&0x0f)-1);
   \   0000006C   8700                       STD     Z+8,R16
   \   0000006E   8711                       STD     Z+9,R17
    236          setrg(adr,tmp);
   \   00000070   019A                       MOVW    R19 : R18,R21 : R20
   \   00000072   018B                       MOVW    R17 : R16,R23 : R22
   \   00000074   ........                   CALL    setrg
    237          ramb[0x0f]=0;
   \   00000078   E000                       LDI     R16,0
   \   0000007A   01FD                       MOVW    R31 : R30,R27 : R26
   \   0000007C   8F06                       STD     Z+30,R16
   \   0000007E   8F07                       STD     Z+31,R16
    238          
    239          };
   \                     ??resalarm_0:
   \   00000080   91A9                       LD      R26,Y+
   \   00000082   91B9                       LD      R27,Y+
   \   00000084   9508                       RET
    240          
    241          #define xk1 PING_Bit3
    242          #define xk2 PING_Bit4
    243          #define dev_ver_r PIND_Bit7
    244          #define dev_ver_heat PIND_Bit6
    245          //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   \                                 In segment CODE, align 2, keep-with-next
    246          main(){
    249          __disable_interrupt();
    250          hrem[0x10]=get_sp();
    251          { char * st; int i;
    252            st=(char*)hrem[0x10];
    253            for (i=1;i<0x6a;i++){*st--=0xff;}
    254          }
    255          WDTCR |= (1<<WDCE);
    256          WDTCR |= (1<<WDP0) | (1<<WDP1) | (1<<WDP2);
    257          __enable_interrupt();

    262          inihist(0x11,0x20);

    332          for (;;)
                  { char * st; int i;
    333          st=(char*)hrem[0x10];
    334          //for (i=1;i<0x80;i++){hrem[i+10]=*st--;}
    335          for (i=1;i<0x80;i++){hrem[i+0x10]=*st; st--;}
C:\Documents and Settings\Vadim1\Рабочий стол\mcap01mk_soft\Release\List\tt.lst    336          

ledpr();
    337          wrblock();
    338          // ramb[0x10]=1;
    339          // dev_status=0x105;
    340          if(ramb[0x19]==0xffff){dev_status|=0x8000;config_uLan();}
    341          else {dev_status&=~0x8000; GetT();};
    342            if (((int)ramb[0x20]) < ((int)hrem[0x15f])) {PORTE_Bit2 = 1;}
    343              else PORTE_Bit2 = 0;
   \                     ??main_6:
   \   00000160   981A                       CBI     0x03,0x02
    344          
    345          //PORTE_Bit2 = 0;
    346          
    347          resalarm();
   \                     ??main_7:
   \   00000162   ....                       RCALL   resalarm
    348             __watchdog_reset();
   \   00000164   95A8                       WDR
   \                     ??main_5:
   \   00000166   ....                       LDI     R30,LOW(hrem)
   \   00000168   ....                       LDI     R31,(hrem) >> 8
   \   0000016A   A1A0                       LDD     R26,Z+32
   \   0000016C   A1B1                       LDD     R27,Z+33
   \   0000016E   ....                       LDI     R30,LOW((hrem + 34))
   \   00000170   ....                       LDI     R31,(hrem + 34) >> 8
   \   00000172   E70F                       LDI     R16,127
   \                     ??main_8:
   \   00000174   912C                       LD      R18,X
   \   00000176   E030                       LDI     R19,0
   \   00000178   9321                       ST      Z+,R18
   \   0000017A   9331                       ST      Z+,R19
   \   0000017C   9711                       SBIW    R27 : R26,1
   \   0000017E   950A                       DEC     R16
   \   00000180   F7C9                       BRNE    ??main_8
   \   00000182   ....                       RCALL   ledpr
   \   00000184   ........                   CALL    wrblock
   \   00000188   ....                       LDI     R30,LOW(ramb)
   \   0000018A   ....                       LDI     R31,(ramb) >> 8
   \   0000018C   A902                       LDD     R16,Z+50
   \   0000018E   A913                       LDD     R17,Z+51
   \   00000190   3F0F                       CPI     R16,255
   \   00000192   4F1F                       SBCI    R17,255
   \   00000194   A901                       LDD     R16,Z+49
   \   00000196   F429                       BRNE    ??main_9
   \   00000198   6800                       ORI     R16,0x80
   \   0000019A   AB01                       STD     Z+49,R16
   \   0000019C   ........                   CALL    config_uLan
   \   000001A0   C004                       RJMP    ??main_10
   \                     ??main_9:
   \   000001A2   770F                       ANDI    R16,0x7F
   \   000001A4   AB01                       STD     Z+49,R16
   \   000001A6   ........                   CALL    GetT
   \                     ??main_10:
   \   000001AA   ....                       LDI     R30,LOW((ramb + 64))
   \   000001AC   ....                       LDI     R31,(ramb + 64) >> 8
   \   000001AE   8100                       LD      R16,Z
   \   000001B0   8111                       LDD     R17,Z+1
   \   000001B2   ....                       LDI     R30,LOW((hrem + 702))
   \   000001B4   ....                       LDI     R31,(hrem + 702) >> 8
   \   000001B6   8120                       LD      R18,Z
   \   000001B8   8131                       LDD     R19,Z+1
   \   000001BA   1702                       CP      R16,R18
   \   000001BC   0713                       CPC     R17,R19
   \   000001BE   F684                       BRGE    ??main_6
   \   000001C0   9A1A                       SBI     0x03,0x02
   \   000001C2   CFCF                       RJMP    ??main_7
    349          }
    350          };

   \                                 In segment NEAR_ID, align 1, keep-with-next
   \                     `?<Initializer for hs>`:
   \   00000000   654820797473               DB "Hey stupid\012\015"
   \              707564690D0A
   \              00          

   \                                 In segment SWITCH, align 2, keep-with-next
   \                     `?<Jumptable for getx>_0`:
   \   00000000   ....                       DW      (??getx_1) /2
   \   00000002   ....                       DW      (??getx_2) /2
   \   00000004   ....                       DW      (??getx_3) /2
   \   00000006   ....                       DW      (??getx_4) /2
   \   00000008   ....                       DW      (??getx_5) /2
   \   0000000A   ....                       DW      (??getx_6) /2
   \   0000000C   ....                       DW      (??getx_7) /2
   \   0000000E   ....                       DW      (??getx_8) /2
   \   00000010   ....                       DW      (??getx_9) /2
   \   00000012   ....                       DW      (??getx_10) /2
   \   00000014   ....                       DW      (??getx_11) /2
   \   00000016   ....                       DW      (??getx_12) /2
   \   00000018   ....                       DW      (??getx_13) /2
   \   0000001A   ....                       DW      (??getx_14) /2
   \   0000001C   ....                       DW      (??getx_15) /2
   \   0000001E   ....                       DW      (??getx_16) /2

   \                                 In segment ABSOLUTE, at 0x22
   \   union <unnamed> volatile __io _A_DDRE
   \                     _A_DDRE:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x23
   \   union <unnamed> volatile __io _A_PORTE
   \                     _A_PORTE:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x30
   \   union <unnamed> volatile __io _A_PIND
   \                     _A_PIND:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x32
   \   union <unnamed> volatile __io _A_PORTD
   \                     _A_PORTD:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x34
   \   union <unnamed> volatile __io _A_DDRC
   \                     _A_DDRC:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x35
   \   union <unnamed> volatile __io _A_PORTC
   \                     _A_PORTC:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x38
   \   union <unnamed> volatile __io _A_PORTB
   \                     _A_PORTB:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x3b
   \   union <unnamed> volatile __io _A_PORTA
   \                     _A_PORTA:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x41
   \   union <unnamed> volatile __io _A_WDTCR
   \                     _A_WDTCR:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x63
   \   union <unnamed> volatile __io _A_PING
   \                     _A_PING:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x64
   \   union <unnamed> volatile __io _A_DDRG
   \                     _A_DDRG:
   \   00000000                              DS 1

   \                                 In segment ABSOLUTE, at 0x65
   \   union <unnamed> volatile __io _A_PORTG
   \                     _A_PORTG:
   \   00000000                              DS 1

   Maximum stack usage in bytes:

     Function         CSTACK RSTACK
     --------         ------ ------
     delayloop            0      2
     getx                 0      2
     iniports             0      2
     ledpr                2      2
       -> settout         2      2
       -> gettout         2      2
       -> settout         2      2
       -> settout         2      2
       -> settout         2      2
       -> settout         2      2
       -> gettout         2      2
       -> settout         2      2
       -> settout         2      2
       -> gettout         2      2
     main                 2      2
       -> get_sp          2      2
       -> iniports        2      2
       -> inibase         2      2
       -> initime         2      2
       -> inihist         2      2
       -> Init            2      2
       -> inicomm         2      2
       -> initmb0         2      2
       -> initmb1         2      2
       -> addh            2      2
       -> addh            2      2
       -> addh            2      2
       -> get_temp_id     2      2
       -> addh            2      2
       -> get_sp          2      2
       -> resalarm        2      2
       -> ledpr           2      2
       -> wrblock         2      2
       -> config_uLan     2      2
       -> GetT            2      2
     resalarm             2      4
       -> setrg           2      2
     sendump              8      2
       -> getx            8      2
       -> getx            8      2
       -> getx            8      2
       -> getx            8      2
       -> sen0            8      2
     sentst               2      2
       -> sen0            2      2


   Segment part sizes:

     Function/Label          Bytes
     --------------          -----
     delayloop                 32
     hs                        13
     buf                      255
     cp                         2
     getx                      94
     sendump                  192
     sentst                    68
     iniports                  42
     ledstate                   1
     ledpr                    836
     resalarm                 134
     main                     452
     ?<Initializer for hs>     13
     ?<Jumptable for getx>_0   32
     _A_DDRE                    1
     _A_PORTE                   1
     _A_PIND                    1
     _A_PORTD                   1
     _A_DDRC                    1
     _A_PORTC                   1
     _A_PORTB                   1
     _A_PORTA                   1
     _A_WDTCR                   1
     _A_PING                    1
     _A_DDRG                    1
     _A_PORTG                   1
      Others                   14

 
    12 bytes in segment ABSOLUTE
 1 850 bytes in segment CODE
    14 bytes in segment INITTAB
    13 bytes in segment NEAR_I
    13 bytes in segment NEAR_ID
   258 bytes in segment NEAR_Z
    32 bytes in segment SWITCH
 
 1 895 bytes of CODE memory (+ 14 bytes shared)
   271 bytes of DATA memory (+ 12 bytes shared)

Errors: none
Warnings: 1
